
================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 11:47:02 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_C3
   41| 	y_e1 = y_C3
   42| 	x_e2 = x_C4
   43| 	y_e2 = y_C4
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = 1
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = -1
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  124| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  125| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  126| 
  127| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ELECTRODE1') as 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ELECTRODE2') as 'Electrode 2 current'
ERROR in state 175: GOT: 51(AS) WANTED: 13(<)>)
***** Line 127 Col 108:
FlexPDE grammar does not allow 'AS' in this location.


================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 11:47:25 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_C3
   41| 	y_e1 = y_C3
   42| 	x_e2 = x_C4
   43| 	y_e2 = y_C4
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = 1
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = -1
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  124| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  125| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  126| 
  127| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ELECTRODE2')) AS 'Electrode 2 current'
  128| 
  129| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  130| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  131| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  132| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  133| 
  134| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  135| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  136| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  137| }
  138| 
  139| 	{ export top dipoles data }
  140| {
  141| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dx_z=2_8284.txt' format '#x, #y, #1'
  142| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dy_z=2_8284.txt' format '#x, #y, #1'
  143| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dz_z=2_8284.txt' format '#x, #y, #1'
  144| 
  145| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dx_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dy_z=-2_8284.txt' format '#x, #y, #1'
  147| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dz_z=-2_8284.txt' format '#x, #y, #1'
  148| }	
  149| end
FlexPDE Professional Version 6.36/L64 3D
© 1996-2014 PDE Solutions Inc.
FlexPDE Professional Version 6.36/L64 3D
© 1996-2014 PDE Solutions Inc.
FlexPDE Professional Version 6.36/L64 3D
© 1996-2014 PDE Solutions Inc.
FlexPDE Professional Version 6.36/L64 3D
© 1996-2014 PDE Solutions Inc.
SUBDIVIDE 529
SUBDIVIDE 931
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2830 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          3          3          216
     9          1          2          3          3          216
     9          1          3          3          3          216
     9          1          4          3          3          216
     9          1          5          3          3          216
     9          1          6          3          3          216
     9          1          7          3          3          216
     9          1          8          3          3          216
     9          1          9          3          3          216

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 45, RNORM=3.93978e-06, XNORM=0.306106, 0 MS/IT 0 uS/NODE
Orthomin/ILU ITERATION 66, RNORM=1.5475e-09, XNORM=0.00217531, 4 MS/IT 0.267961 uS/NODE
RMS Spatial Errors  2.624e-4
DO_NEXTSTAGE pde 0x7fe46c034ce0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 11:55:01 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_C3
   41| 	y_e1 = y_C3
   42| 	x_e2 = x_C4
   43| 	y_e2 = y_C4
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = 1
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = -1
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  124| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  125| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  126| 
  127| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  128| 
  129| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  130| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  131| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  132| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  133| 
  134| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  135| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  136| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  137| }
  138| 
  139| 	{ export top dipoles data }
  140| {
  141| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dx_z=2_8284.txt' format '#x, #y, #1'
  142| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dy_z=2_8284.txt' format '#x, #y, #1'
  143| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dz_z=2_8284.txt' format '#x, #y, #1'
  144| 
  145| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dx_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dy_z=-2_8284.txt' format '#x, #y, #1'
  147| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dz_z=-2_8284.txt' format '#x, #y, #1'
  148| }	
  149| end
SUBDIVIDE 529
SUBDIVIDE 931
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2660 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          3          3          216
     9          1          2          3          3          216
     9          1          3          3          3          216
     9          1          4          3          3          216
     9          1          5          3          3          216
     9          1          6          3          3          216
     9          1          7          3          3          216
     9          1          8          3          3          216
     9          1          9          3          3          216

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 45, RNORM=3.93978e-06, XNORM=0.306106, 2 MS/IT 0.135097 uS/NODE
Orthomin/ILU ITERATION 66, RNORM=1.5475e-09, XNORM=0.00217531, 3 MS/IT 0.167476 uS/NODE
RMS Spatial Errors  2.624e-4
DO_NEXTSTAGE pde 0x7fe46c06c5c0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 11:56:19 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_C3
   41| 	y_e1 = y_C3
   42| 	x_e2 = x_C4
   43| 	y_e2 = y_C4
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = 1
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = -1
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| 
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| 
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  124| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  125| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  126| 
  127| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  128| 
  129| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  130| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  131| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  132| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  133| 
  134| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  135| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  136| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  137| }
  138| 
  139| 	{ export top dipoles data }
  140| {
  141| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dx_z=2_8284.txt' format '#x, #y, #1'
  142| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dy_z=2_8284.txt' format '#x, #y, #1'
  143| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dz_z=2_8284.txt' format '#x, #y, #1'
  144| 
  145| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dx_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dy_z=-2_8284.txt' format '#x, #y, #1'
  147| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dz_z=-2_8284.txt' format '#x, #y, #1'
  148| }	
  149| end
SUBDIVIDE 515
SUBDIVIDE 880
SUBDIVIDE 1135
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 3140 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          3          3          216
     9          1          2          3          3          216
     9          1          3          3          3          216
     9          1          4          3          3          216
     9          1          5          3          3          216
     9          1          6          3          3          216
     9          1          7          3          3          216
     9          1          8          3          3          216
     9          1          9          3          3          216

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4           

Orthomin/DInv ITERATION 134, RNORM=1.0607e-05, XNORM=0.559188, 0 MS/IT 0.0404801 uS/NODE
Orthomin/DInv ITERATION 257, RNORM=2.02578e-09, XNORM=0.000637258, 0 MS/IT 0.0383752 uS/NODE
RMS Spatial Errors  3.180e-4
DO_NEXTSTAGE pde 0x7fe46c06c5c0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 11:56:57 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_C3
   41| 	y_e1 = y_C3
   42| 	x_e2 = x_C4
   43| 	y_e2 = y_C4
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = 0.5
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = -0.5
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  124| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  125| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  126| 
  127| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  128| 
  129| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  130| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  131| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  132| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  133| 
  134| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  135| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  136| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  137| }
  138| 
  139| 	{ export top dipoles data }
  140| {
  141| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dx_z=2_8284.txt' format '#x, #y, #1'
  142| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dy_z=2_8284.txt' format '#x, #y, #1'
  143| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dz_z=2_8284.txt' format '#x, #y, #1'
  144| 
  145| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dx_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dy_z=-2_8284.txt' format '#x, #y, #1'
  147| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dz_z=-2_8284.txt' format '#x, #y, #1'
  148| }	
  149| end
SUBDIVIDE 529
SUBDIVIDE 931
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2630 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          3          3          216
     9          1          2          3          3          216
     9          1          3          3          3          216
     9          1          4          3          3          216
     9          1          5          3          3          216
     9          1          6          3          3          216
     9          1          7          3          3          216
     9          1          8          3          3          216
     9          1          9          3          3          216

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 45, RNORM=1.96989e-06, XNORM=0.153053, 2 MS/IT 0.135097 uS/NODE
Orthomin/ILU ITERATION 66, RNORM=7.95345e-10, XNORM=0.00108765, 2 MS/IT 0.13398 uS/NODE
RMS Spatial Errors  2.624e-4
DO_NEXTSTAGE pde 0x7fe46c06c5c0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 11:57:14 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_C3
   41| 	y_e1 = y_C3
   42| 	x_e2 = x_C4
   43| 	y_e2 = y_C4
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = 0.25
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = -0.25
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  124| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  125| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  126| 
  127| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  128| 
  129| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  130| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  131| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  132| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  133| 
  134| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  135| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  136| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  137| }
  138| 
  139| 	{ export top dipoles data }
  140| {
  141| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dx_z=2_8284.txt' format '#x, #y, #1'
  142| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dy_z=2_8284.txt' format '#x, #y, #1'
  143| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dz_z=2_8284.txt' format '#x, #y, #1'
  144| 
  145| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dx_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dy_z=-2_8284.txt' format '#x, #y, #1'
  147| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dz_z=-2_8284.txt' format '#x, #y, #1'
  148| }	
  149| end
SUBDIVIDE 529
SUBDIVIDE 931
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2620 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          3          3          216
     9          1          2          3          3          216
     9          1          3          3          3          216
     9          1          4          3          3          216
     9          1          5          3          3          216
     9          1          6          3          3          216
     9          1          7          3          3          216
     9          1          8          3          3          216
     9          1          9          3          3          216

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 45, RNORM=9.84946e-07, XNORM=0.0765265, 2 MS/IT 0.135097 uS/NODE
Orthomin/ILU ITERATION 66, RNORM=3.86876e-10, XNORM=0.000543827, 2 MS/IT 0.13398 uS/NODE
RMS Spatial Errors  2.624e-4
DO_NEXTSTAGE pde 0x7fe46c06c5c0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 11:59:01 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_C3
   41| 	y_e1 = y_C3
   42| 	x_e2 = x_C4
   43| 	y_e2 = y_C4
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = 0.22
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = -0.22
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  124| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  125| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  126| 
  127| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  128| 
  129| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  130| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  131| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  132| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  133| 
  134| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  135| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  136| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  137| }
  138| 
  139| 	{ export top dipoles data }
  140| {
  141| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dx_z=2_8284.txt' format '#x, #y, #1'
  142| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dy_z=2_8284.txt' format '#x, #y, #1'
  143| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dz_z=2_8284.txt' format '#x, #y, #1'
  144| 
  145| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dx_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dy_z=-2_8284.txt' format '#x, #y, #1'
  147| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dz_z=-2_8284.txt' format '#x, #y, #1'
  148| }	
  149| end
SUBDIVIDE 529
SUBDIVIDE 931
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2640 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          3          3          216
     9          1          2          3          3          216
     9          1          3          3          3          216
     9          1          4          3          3          216
     9          1          5          3          3          216
     9          1          6          3          3          216
     9          1          7          3          3          216
     9          1          8          3          3          216
     9          1          9          3          3          216

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 45, RNORM=8.66752e-07, XNORM=0.0673433, 2 MS/IT 0.135097 uS/NODE
Orthomin/ILU ITERATION 66, RNORM=3.46665e-10, XNORM=0.000478568, 2 MS/IT 0.13398 uS/NODE
RMS Spatial Errors  2.624e-4
DO_NEXTSTAGE pde 0x7fe46c06c5c0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 11:59:19 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_C3
   41| 	y_e1 = y_C3
   42| 	x_e2 = x_C4
   43| 	y_e2 = y_C4
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = 0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = -0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  124| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  125| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  126| 
  127| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  128| 
  129| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  130| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  131| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  132| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  133| 
  134| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  135| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  136| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  137| }
  138| 
  139| 	{ export top dipoles data }
  140| {
  141| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dx_z=2_8284.txt' format '#x, #y, #1'
  142| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dy_z=2_8284.txt' format '#x, #y, #1'
  143| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dz_z=2_8284.txt' format '#x, #y, #1'
  144| 
  145| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dx_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dy_z=-2_8284.txt' format '#x, #y, #1'
  147| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dz_z=-2_8284.txt' format '#x, #y, #1'
  148| }	
  149| end
SUBDIVIDE 529
SUBDIVIDE 931
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2640 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          3          3          216
     9          1          2          3          3          216
     9          1          3          3          3          216
     9          1          4          3          3          216
     9          1          5          3          3          216
     9          1          6          3          3          216
     9          1          7          3          3          216
     9          1          8          3          3          216
     9          1          9          3          3          216

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 45, RNORM=9.45548e-07, XNORM=0.0734654, 2 MS/IT 0.135097 uS/NODE
Orthomin/ILU ITERATION 66, RNORM=3.68246e-10, XNORM=0.000522074, 2 MS/IT 0.13398 uS/NODE
RMS Spatial Errors  2.624e-4
DO_NEXTSTAGE pde 0x7fe46c06c5c0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:02:43 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc1
   41| 	y_e1 = y_Fc1
   42| 	x_e2 = x_Fc2
   43| 	y_e2 = y_Fc2
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = 0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = -0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2430 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/DInv ITERATION 129, RNORM=2.81788e-06, XNORM=0.114307, 0 MS/IT 0.0409313 uS/NODE
Orthomin/DInv ITERATION 249, RNORM=1.03046e-09, XNORM=0.000286837, 0 MS/IT 0.0400546 uS/NODE
RMS Spatial Errors  3.440e-4
DO_NEXTSTAGE pde 0x7fe46c06c5c0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:05:26 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc1
   41| 	y_e1 = y_Fc1
   42| 	x_e2 = x_Cp1
   43| 	y_e2 = y_Cp1
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = 0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = -0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2300 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 45, RNORM=5.27801e-07, XNORM=0.0602248, 2 MS/IT 0.133323 uS/NODE
Orthomin/ILU ITERATION 64, RNORM=2.9483e-10, XNORM=0.000478672, 2 MS/IT 0.140614 uS/NODE
RMS Spatial Errors  3.411e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:06:34 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc1
   41| 	y_e1 = y_Fc1
   42| 	x_e2 = x_Cp1
   43| 	y_e2 = y_Cp1
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2390 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 45, RNORM=5.27801e-07, XNORM=0.0602248, 2 MS/IT 0.133323 uS/NODE
Orthomin/ILU ITERATION 64, RNORM=2.9483e-10, XNORM=0.000478672, 2 MS/IT 0.13124 uS/NODE
RMS Spatial Errors  3.411e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:07:13 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc1
   41| 	y_e1 = y_Fc1
   42| 	x_e2 = x_Fc2
   43| 	y_e2 = y_Fc2
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2440 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/DInv ITERATION 129, RNORM=2.81788e-06, XNORM=0.114307, 0 MS/IT 0.0363834 uS/NODE
Orthomin/DInv ITERATION 249, RNORM=1.03046e-09, XNORM=0.000286837, 0 MS/IT 0.0400546 uS/NODE
RMS Spatial Errors  3.440e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:08:03 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc1
   41| 	y_e1 = y_Fc1
   42| 	x_e2 = x_Cp2
   43| 	y_e2 = y_Cp2
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 471
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2460 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/DInv ITERATION 153, RNORM=1.37696e-05, XNORM=0.125268, 0 MS/IT 0.0385056 uS/NODE
Orthomin/DInv ITERATION 277, RNORM=2.81306e-09, XNORM=0.000850999, 0 MS/IT 0.0404101 uS/NODE
RMS Spatial Errors  3.019e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:08:31 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc1
   41| 	y_e1 = y_Fc1
   42| 	x_e2 = x_Cp1
   43| 	y_e2 = y_Cp1
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2330 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 45, RNORM=5.27801e-07, XNORM=0.0602248, 2 MS/IT 0.133323 uS/NODE
Orthomin/ILU ITERATION 64, RNORM=2.9483e-10, XNORM=0.000478672, 2 MS/IT 0.140614 uS/NODE
RMS Spatial Errors  3.411e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:09:04 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc1
   41| 	y_e1 = y_Fc1
   42| 	x_e2 = x_Fc2
   43| 	y_e2 = y_Fc2
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2400 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/DInv ITERATION 129, RNORM=2.81788e-06, XNORM=0.114307, 0 MS/IT 0.0363834 uS/NODE
Orthomin/DInv ITERATION 249, RNORM=1.03046e-09, XNORM=0.000286837, 0 MS/IT 0.0400546 uS/NODE
RMS Spatial Errors  3.440e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:09:28 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc1
   41| 	y_e1 = y_Fc1
   42| 	x_e2 = x_Cp1
   43| 	y_e2 = y_Cp1
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2480 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 45, RNORM=5.27801e-07, XNORM=0.0602248, 2 MS/IT 0.133323 uS/NODE
Orthomin/ILU ITERATION 64, RNORM=2.9483e-10, XNORM=0.000478672, 2 MS/IT 0.13124 uS/NODE
RMS Spatial Errors  3.411e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:09:58 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc1
   41| 	y_e1 = y_Fc1
   42| 	x_e2 = x_Cp2
   43| 	y_e2 = y_Cp2
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair3_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair3_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair3_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair3_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair3_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair3_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 471
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2450 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/DInv ITERATION 153, RNORM=1.37696e-05, XNORM=0.125268, 0 MS/IT 0.0385056 uS/NODE
Orthomin/DInv ITERATION 277, RNORM=2.81306e-09, XNORM=0.000850999, 0 MS/IT 0.0382832 uS/NODE
RMS Spatial Errors  3.019e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:10:24 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc1
   41| 	y_e1 = y_Fc1
   42| 	x_e2 = x_C3
   43| 	y_e2 = y_C3
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 672
SUBDIVIDE 776
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2610 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/DInv ITERATION 252, RNORM=5.63883e-07, XNORM=0.118314, 0 MS/IT 0.0388731 uS/NODE
Orthomin/DInv ITERATION 266, RNORM=4.32187e-11, XNORM=1.87964e-05, 0 MS/IT 0.0389934 uS/NODE
RMS Spatial Errors  3.804e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:10:47 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc1
   41| 	y_e1 = y_Fc1
   42| 	x_e2 = x_C3
   43| 	y_e2 = y_C3
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.22
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.22
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 672
SUBDIVIDE 776
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2630 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/DInv ITERATION 250, RNORM=6.21767e-07, XNORM=0.108455, 0 MS/IT 0.039184 uS/NODE
Orthomin/DInv ITERATION 264, RNORM=5.3905e-11, XNORM=1.93809e-05, 0 MS/IT 0.0392888 uS/NODE
RMS Spatial Errors  3.804e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:11:03 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc1
   41| 	y_e1 = y_Fc1
   42| 	x_e2 = x_C3
   43| 	y_e2 = y_C3
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.2
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.2
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 672
SUBDIVIDE 776
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2620 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/DInv ITERATION 244, RNORM=8.33364e-07, XNORM=0.0985947, 0 MS/IT 0.0401476 uS/NODE
Orthomin/DInv ITERATION 265, RNORM=7.93141e-11, XNORM=2.48587e-05, 0 MS/IT 0.0391406 uS/NODE
RMS Spatial Errors  3.804e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:11:36 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc1
   41| 	y_e1 = y_Fc1
   42| 	x_e2 = x_C4
   43| 	y_e2 = y_C4
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.2
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.2
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair5_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair5_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair5_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair5_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair5_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair5_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2370 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/DInv ITERATION 239, RNORM=1.05386e-06, XNORM=0.111546, 0 MS/IT 0.0388518 uS/NODE
Orthomin/DInv ITERATION 259, RNORM=1.87607e-10, XNORM=4.94218e-05, 0 MS/IT 0.0380924 uS/NODE
RMS Spatial Errors  3.478e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:11:50 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc1
   41| 	y_e1 = y_Fc1
   42| 	x_e2 = x_C4
   43| 	y_e2 = y_C4
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair5_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair5_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair5_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair5_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair5_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair5_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2380 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/DInv ITERATION 238, RNORM=1.35753e-06, XNORM=0.133855, 0 MS/IT 0.0390151 uS/NODE
Orthomin/DInv ITERATION 268, RNORM=1.63806e-10, XNORM=6.39994e-05, 0 MS/IT 0.0389787 uS/NODE
RMS Spatial Errors  3.478e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:12:26 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc2
   41| 	y_e1 = y_Fc2
   42| 	x_e2 = x_Cp1
   43| 	y_e2 = y_Cp1
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair6_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair6_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair6_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair6_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair6_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair6_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 516
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2530 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 44, RNORM=6.54979e-07, XNORM=0.0657356, 2 MS/IT 0.145654 uS/NODE
Orthomin/ILU ITERATION 67, RNORM=3.23477e-10, XNORM=0.000471853, 2 MS/IT 0.139132 uS/NODE
RMS Spatial Errors  2.915e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:12:59 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc2
   41| 	y_e1 = y_Fc2
   42| 	x_e2 = x_Cp2
   43| 	y_e2 = y_Cp2
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair7_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair7_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair7_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair7_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair7_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair7_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 757
SUBDIVIDE 758
SUBDIVIDE 759
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2490 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 49, RNORM=6.90922e-07, XNORM=0.0606593, 2 MS/IT 0.131181 uS/NODE
Orthomin/ILU ITERATION 78, RNORM=2.12587e-10, XNORM=0.000111748, 2 MS/IT 0.13485 uS/NODE
RMS Spatial Errors  3.370e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:13:29 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Fc2
   41| 	y_e1 = y_Fc2
   42| 	x_e2 = x_C3
   43| 	y_e2 = y_C3
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair8_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair8_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair8_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair8_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair8_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair8_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 946
SUBDIVIDE 945
SUBDIVIDE 947
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2580 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 79, RNORM=1.51661e-07, XNORM=0.0690414, 2 MS/IT 0.137127 uS/NODE
Orthomin/ILU ITERATION 55, RNORM=7.97678e-11, XNORM=4.57236e-06, 2 MS/IT 0.134765 uS/NODE
RMS Spatial Errors  3.208e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:14:08 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Cp1
   41| 	y_e1 = y_Cp1
   42| 	x_e2 = x_Cp2
   43| 	y_e2 = y_Cp2
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair10_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair10_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair10_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair10_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair10_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair10_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 451
SUBDIVIDE 714
SUBDIVIDE 715
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2490 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/DInv ITERATION 150, RNORM=9.37489e-06, XNORM=0.117304, 0 MS/IT 0.0388976 uS/NODE
Orthomin/DInv ITERATION 275, RNORM=3.61906e-09, XNORM=0.000983781, 0 MS/IT 0.0381904 uS/NODE
RMS Spatial Errors  3.217e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:14:37 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Cp1
   41| 	y_e1 = y_Cp1
   42| 	x_e2 = x_C3
   43| 	y_e2 = y_C3
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 830
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2540 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 78, RNORM=1.63804e-07, XNORM=0.0618989, 2 MS/IT 0.135333 uS/NODE
Orthomin/ILU ITERATION 53, RNORM=1.24246e-10, XNORM=6.43275e-06, 2 MS/IT 0.132779 uS/NODE
RMS Spatial Errors  4.161e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:14:57 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Cp1
   41| 	y_e1 = y_Cp1
   42| 	x_e2 = x_C3
   43| 	y_e2 = y_C3
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.23
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.23
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 830
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2530 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 78, RNORM=1.56585e-07, XNORM=0.0593198, 2 MS/IT 0.142851 uS/NODE
Orthomin/ILU ITERATION 53, RNORM=1.18909e-10, XNORM=6.16216e-06, 2 MS/IT 0.132779 uS/NODE
RMS Spatial Errors  4.161e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:15:17 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Cp1
   41| 	y_e1 = y_Cp1
   42| 	x_e2 = x_C3
   43| 	y_e2 = y_C3
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.22
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.22
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 830
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2550 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 78, RNORM=1.50014e-07, XNORM=0.0567407, 2 MS/IT 0.135333 uS/NODE
Orthomin/ILU ITERATION 53, RNORM=1.14408e-10, XNORM=5.89577e-06, 2 MS/IT 0.143844 uS/NODE
RMS Spatial Errors  4.161e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:15:51 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Cp1
   41| 	y_e1 = y_Cp1
   42| 	x_e2 = x_C4
   43| 	y_e2 = y_C4
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.22
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.22
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair12_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair12_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair12_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair12_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair12_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair12_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 946
SUBDIVIDE 945
SUBDIVIDE 947
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2570 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 78, RNORM=1.54636e-07, XNORM=0.0640547, 2 MS/IT 0.133154 uS/NODE
Orthomin/ILU ITERATION 82, RNORM=8.98751e-12, XNORM=4.73836e-06, 2 MS/IT 0.133695 uS/NODE
RMS Spatial Errors  3.150e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:16:13 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_Cp1
   41| 	y_e1 = y_Cp1
   42| 	x_e2 = x_C4
   43| 	y_e2 = y_C4
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair12_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair12_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair12_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair12_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair12_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair12_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 946
SUBDIVIDE 945
SUBDIVIDE 947
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2620 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 78, RNORM=1.68702e-07, XNORM=0.0698778, 2 MS/IT 0.133154 uS/NODE
Orthomin/ILU ITERATION 82, RNORM=9.80431e-12, XNORM=5.16916e-06, 2 MS/IT 0.133695 uS/NODE
RMS Spatial Errors  3.150e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells_v2.pde 12:16:40 4/9/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres, with Electrodes corrections'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	CD = -sigma*grad(V)	{ current density }
   20| 	{ electrode positions }
   21| 	{ Fc1 }
   22| 	x_Fc1 = 3.511
   23| 	y_Fc1 = 3.502
   24| 	{ Fc2 }
   25| 	x_Fc2 = 3.511
   26| 	y_Fc2 = -3.502
   27| 	{ Cp1 }
   28| 	x_Cp1 = -3.510
   29| 	y_Cp1 = 3.502
   30| 	{ Cp2 }
   31| 	x_Cp2 = -3.510
   32| 	y_Cp2 = -3.502
   33| 	{ C3 }
   34| 	x_C3 = 0
   35| 	y_C3 = 6.837
   36| 	{ C4 }
   37| 	x_C4 = 0
   38| 	y_C4 = -6.837
   39| 	{ electrode location }
   40| 	x_e1 = x_C3
   41| 	y_e1 = y_C3
   42| 	x_e2 = x_C4
   43| 	y_e2 = y_C4
   44| 	x_g = (x_e1+x_e2)/2
   45| 	y_g = (y_e1+y_e2)/2
   46| 	{ electrode patch radius }
   47| 	r_e = 0.5	 { 1cm diameter electrode }
   48| 
   49| EQUATIONS
   50|     div(-sigma*grad(V)) = 0
   51| 
   52| EXTRUSION
   53|     { z from low to high }
   54|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   55|         layer 'LB1'
   56| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   57| 		layer 'LB2'
   58| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   59| 		layer 'L3'
   60| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   61| 		layer 'LT2'
   62| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   63| 		layer 'LT1'
   64|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   65| 
   66| BOUNDARIES
   67|     
   68|     surface 'ST1' natural(V) = 0
   69|     surface 'SB1' natural(V) = 0
   70| 	
   71| 	Region 1
   72| 		layer 'LT1' sigma=sigma_sc
   73| 		layer 'LB1' sigma=sigma_sc
   74| 		start(R_sc, 0)
   75| 		arc(center=0,0) angle=360
   76| 		line to close
   77| 
   78| { Electrode 1 }
   79| 	Limited Region  'ELECTRODE1'
   80| 		surface 'ST1'
   81| 		!natural(V) = 1/(PI*(r_e^2))
   82| 		value(V) = -0.24
   83|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   84| 		line to close
   85| 
   86| { Electrode 2 }
   87| 	Limited Region 'ELECTRODE2'
   88| 		surface 'ST1'
   89| 		!natural(V) = -1/(PI*(r_e^2))
   90| 		value(V) = 0.24
   91| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   92| 		LINE TO CLOSE
   93| 
   94| 
   95| { 'Ground electrode' }
   96| {
   97| 	Limited Region 3 { arbitrary ground point as a test }
   98| 		{ Ground voltage value between the electrodes }
   99| 		surface 'ST1'
  100| 		value(V) = 0
  101| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
  102| 		line to close
  103| }
  104| 	Limited Region 3 { the skull region }
  105| 		layer 'LT2' sigma = sigma_sk
  106| 		layer 'LB2' sigma = sigma_sk
  107| 			! region in all layers that must merge out:
  108| 			layer 'L3'
  109| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  110| 		line to close
  111| 
  112| 	Limited Region 5 { the brain region }
  113| 		layer 'L3' sigma = sigma_br
  114| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  115| 		line to close
  116| 
  117| 
  118| PLOTS
  119| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  120| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  121| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  122| 
  123| {
  124| 	contour(V) on x=0 on 'L3' as 'Potential on YZ plane through diameter in brain'
  125| 	contour(V) on y=0 on 'L3' as 'Potential on XZ plane through diameter in brain'
  126| 	contour(V) on z=0 on 'L3' as 'Potential on XY plane through diameter in brain'
  127| }
  128| 	contour(V) on 'ST1' as 'Potential along top of the head' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE1')) AS 'Electrode 1 current' REPORT(SURF_INTEGRAL(normal(CD), 'ST1', 'ELECTRODE2')) AS 'Electrode 2 current'
  129| 
  130| {
  131| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  132| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  133| 	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  134| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  135| 
  136| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  137| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  138| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  139| }
  140| 
  141| 	{ export top dipoles data }
  142| 
  143| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dx_z=2_8284.txt' format '#x, #y, #1'
  144| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dy_z=2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dz_z=2_8284.txt' format '#x, #y, #1'
  146| 
  147| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dx_z=-2_8284.txt' format '#x, #y, #1'
  148| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dy_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dz_z=-2_8284.txt' format '#x, #y, #1'
  150| 	
  151| end
SUBDIVIDE 529
SUBDIVIDE 931
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 4
MESH GENERATION LAYER 3 REGION 5
MESH GENERATION LAYER 4 REGION 4
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2640 MS

SUMMARIZE 28 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
             CD      1                   13        936
             CD      2                   13        936
             CD      3                   13        936
             CD      4                   13        936
             CD      5                   13        936
             CD      6                   13        936
             CD      7                   13        936
             CD      8                   13        936
             CD      9                   13        936
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          1         72
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          1         72
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          1         72
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          1         72
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          1         72
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          1         72
     3          3       Var  1 Surf Jacobian          1         72

--------------------------------
SUMMARIZE FITS AND INTEGRALS
---------------------------------
                                  REGION/       BASE        CSE
    FIT         KIND            COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------------------
     1     Surface Integral          9             14         14         1008
     2     Surface Integral          9             14         14         1008

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          1          1           72
     7          1          2          1          1           72
     7          1          3          1          1           72
     7          1          4          1          1           72
     7          1          5          1          1           72
     7          1          6          1          1           72
     7          1          7          1          1           72
     7          1          8          1          1           72
     7          1          9          1          1           72
     8          1          1          1          1           72
     8          1          2          1          1           72
     8          1          3          1          1           72
     8          1          4          1          1           72
     8          1          5          1          1           72
     8          1          6          1          1           72
     8          1          7          1          1           72
     8          1          8          1          1           72
     8          1          9          1          1           72
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               CD              X_FC1           Y_FC1           X_FC2          
 Y_FC2           X_CP1           Y_CP1           X_CP2           Y_CP2          
 X_C3            Y_C3            X_C4            Y_C4            X_G            
 Y_G            

Orthomin/ILU ITERATION 45, RNORM=9.45548e-07, XNORM=0.0734654, 2 MS/IT 0.135097 uS/NODE
Orthomin/ILU ITERATION 66, RNORM=3.68246e-10, XNORM=0.000522074, 2 MS/IT 0.13398 uS/NODE
RMS Spatial Errors  2.624e-4
DO_NEXTSTAGE pde 0x7fe46e0499f0  MAXSTAGE=0
