
================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 11:53:54 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8
   17| 	R_br = 6
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 
   25| EQUATIONS
   26|     div(-sigma*grad(V)) = 0
   27| 
   28| EXTRUSION
   29|     { z from low to high }
   30|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   31|         layer 'LB1'
   32| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   33| 		layer 'LB2'
   34| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   35| 		layer 'L3'
   36| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   37| 		layer 'LT2'
   38| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   39| 		layer 'LT1'
   40|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   41| 
   42| BOUNDARIES
   43|     
   44|     surface 'ST1' natural(V) = 0
   45|     surface 'SB1' natural(V) = 0
   46| 	
   47| 	Region 1
   48| 		layer 'L1' sigma=sigma_br
***** Line 48 Col 13:
Unknown Layer Name

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 11:54:31 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8
   17| 	R_br = 6
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 
   25| EQUATIONS
   26|     div(-sigma*grad(V)) = 0
   27| 
   28| EXTRUSION
   29|     { z from low to high }
   30|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   31|         layer 'LB1'
   32| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   33| 		layer 'LB2'
   34| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   35| 		layer 'L3'
   36| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   37| 		layer 'LT2'
   38| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   39| 		layer 'LT1'
   40|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   41| 
   42| BOUNDARIES
   43|     
   44|     surface 'ST1' natural(V) = 0
   45|     surface 'SB1' natural(V) = 0
   46| 	
   47| 	Region 1
   48| 		layer 'LT1' sigma=sigma_sc
   49| 		layer 'LB1' sigma=sigma_sc
   50| 		start(R_sc, 0)
   51| 		arc(center=0,0) angle=360
   52| 		line to close
   53| 
   54| 
   55| 	Limited Region  'ELECTRODE1'
   56| 		{ Fz: (6.578, 0, 6.440) }
   57| 		x_e = 6.578
   58| 		y_e = 0
   59| 		surface 'ST1'
   60| 		natural(V) = 10/(PI*(r_e^2))
   61|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 { Cz, 1mA }
   62| 		line to close
   63| 
   64| 	Limited Region 'ELECTRODE2'
   65| 		{ Cz: (0, 0, 9.2) }
   66| 		x_e = 0
   67| 		y_e = 0
   68| 		surface 'ST1'
   69| 		natural(V) = -10/(PI*(r_e^2))
   70| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 {Fz, -1mA}
   71| 		LINE TO CLOSE
   72| 
   73| 
   74| 	Limited Region 3 { arbitrary ground point as a test }
   75| 		{ Ground voltage value between the electrodes }
   76| 		x_e = 6.578/2
   77| 		y_e = 0
   78| 		surface 'ST1'
   79| 		value(V) = 0
   80| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   81| 		line to close
   82| 
   83| 	Limited Region 4 { the skull region }
   84| 		layer 'LT2' sigma = sigma_sk
   85| 		layer 'LB2' sigma = sigma_sk
   86| 			! region in all layers that must merge out:
   87| 			layer 'L3'
   88| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
   89| 		line to close
   90| 
   91| 	Limited Region 5 { the brain region }
   92| 		layer 'L3' sigma = sigma_br
   93| 		start(R_br, 0) arc(center=0,0) ANGLE=360
   94| 		line to close
   95| 
   96| 
   97| PLOTS
   98| 	grid(x,y,z)
   99| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  100| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  101| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  102| 	contour(V) on SURFACE 'ST1'
  103| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  104| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  105| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  106| 
  107| 
  108| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  109| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  110| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  111| 
  112| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  113| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  114| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  115| }
  116| 
  117| 	{ export electrodes data }
  118| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  119| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  120| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  121| 
  122| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  123| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  124| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  125| 	
  126| { bot electrodes }
  127| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  128| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  129| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  130| 
  131| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  132| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  133| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  134| 	
  135| end
FlexPDE Professional Version 6.36/L64 3D
© 1996-2014 PDE Solutions Inc.
FlexPDE Professional Version 6.36/L64 3D
© 1996-2014 PDE Solutions Inc.
FlexPDE Professional Version 6.36/L64 3D
© 1996-2014 PDE Solutions Inc.
FlexPDE Professional Version 6.36/L64 3D
© 1996-2014 PDE Solutions Inc.
GRID_SURFACE Domainonly=1 db=0
GRID_SURFACE Domainonly=1 db=0
GRID_SURFACE Domainonly=1 db=0
GRID_SURFACE Domainonly=1 db=0
GRID_SURFACE Domainonly=1 db=0
GRID_SURFACE Domainonly=1 db=0
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2610 MS

SUMMARIZE 11 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R              

Orthomin/DInv ITERATION 273, RNORM=2.31155e-05, XNORM=1.85415, 0 MS/IT 0.0348143 uS/NODE
Orthomin/DInv ITERATION 324, RNORM=5.11429e-09, XNORM=0.00136632, 0 MS/IT 0.0361038 uS/NODE
RMS Spatial Errors  1.545e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 11:57:41 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.56
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8
   17| 	R_br = 6
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 
   25| EQUATIONS
   26|     div(-sigma*grad(V)) = 0
   27| 
   28| EXTRUSION
   29|     { z from low to high }
   30|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   31|         layer 'LB1'
   32| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   33| 		layer 'LB2'
   34| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   35| 		layer 'L3'
   36| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   37| 		layer 'LT2'
   38| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   39| 		layer 'LT1'
   40|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   41| 
   42| BOUNDARIES
   43|     
   44|     surface 'ST1' natural(V) = 0
   45|     surface 'SB1' natural(V) = 0
   46| 	
   47| 	Region 1
   48| 		layer 'LT1' sigma=sigma_sc
   49| 		layer 'LB1' sigma=sigma_sc
   50| 		start(R_sc, 0)
   51| 		arc(center=0,0) angle=360
   52| 		line to close
   53| 
   54| 
   55| 	Limited Region  'ELECTRODE1'
   56| 		{ Fz: (6.578, 0, 6.440) }
   57| 		x_e = 6.578
   58| 		y_e = 0
   59| 		surface 'ST1'
   60| 		natural(V) = 10/(PI*(r_e^2))
   61|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 { Cz, 1mA }
   62| 		line to close
   63| 
   64| 	Limited Region 'ELECTRODE2'
   65| 		{ Cz: (0, 0, 9.2) }
   66| 		x_e = 0
   67| 		y_e = 0
   68| 		surface 'ST1'
   69| 		natural(V) = -10/(PI*(r_e^2))
   70| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 {Fz, -1mA}
   71| 		LINE TO CLOSE
   72| 
   73| 
   74| 	Limited Region 3 { arbitrary ground point as a test }
   75| 		{ Ground voltage value between the electrodes }
   76| 		x_e = 6.578/2
   77| 		y_e = 0
   78| 		surface 'ST1'
   79| 		value(V) = 0
   80| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   81| 		line to close
   82| 
   83| 	Limited Region 4 { the skull region }
   84| 		layer 'LT2' sigma = sigma_sk
   85| 		layer 'LB2' sigma = sigma_sk
   86| 			! region in all layers that must merge out:
   87| 			layer 'L3'
   88| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
   89| 		line to close
   90| 
   91| 	Limited Region 5 { the brain region }
   92| 		layer 'L3' sigma = sigma_br
   93| 		start(R_br, 0) arc(center=0,0) ANGLE=360
   94| 		line to close
   95| 
   96| 
   97| PLOTS
   98| 	grid(x,y,z)
   99| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  100| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  101| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  102| 	contour(V) on SURFACE 'ST1'
  103| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  104| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  105| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  106| 
  107| 
  108| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  109| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  110| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  111| 
  112| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  113| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  114| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  115| }
  116| 
  117| 	{ export electrodes data }
  118| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  119| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  120| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  121| 
  122| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  123| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  124| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  125| 	
  126| { bot electrodes }
  127| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  128| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  129| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  130| 
  131| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  132| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  133| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  134| 	
  135| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 1960 MS

SUMMARIZE 11 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R              

Orthomin/DInv ITERATION 212, RNORM=1.90714e-05, XNORM=1.74677, 0 MS/IT 0.0344859 uS/NODE
Orthomin/DInv ITERATION 153, RNORM=3.48222e-08, XNORM=0.000757827, 0 MS/IT 0.0334491 uS/NODE
Orthomin/DInv ITERATION 126, RNORM=4.09312e-09, XNORM=4.11211e-05, 0 MS/IT 0.0348143 uS/NODE
RMS Spatial Errors  1.417e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:03:34 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.072
   13| 	sigma_sc = 1.7
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8
   17| 	R_br = 6
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 
   25| EQUATIONS
   26|     div(-sigma*grad(V)) = 0
   27| 
   28| EXTRUSION
   29|     { z from low to high }
   30|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   31|         layer 'LB1'
   32| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   33| 		layer 'LB2'
   34| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   35| 		layer 'L3'
   36| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   37| 		layer 'LT2'
   38| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   39| 		layer 'LT1'
   40|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   41| 
   42| BOUNDARIES
   43|     
   44|     surface 'ST1' natural(V) = 0
   45|     surface 'SB1' natural(V) = 0
   46| 	
   47| 	Region 1
   48| 		layer 'LT1' sigma=sigma_sc
   49| 		layer 'LB1' sigma=sigma_sc
   50| 		start(R_sc, 0)
   51| 		arc(center=0,0) angle=360
   52| 		line to close
   53| 
   54| 
   55| 	Limited Region  'ELECTRODE1'
   56| 		{ Fz: (6.578, 0, 6.440) }
   57| 		x_e = 6.578
   58| 		y_e = 0
   59| 		surface 'ST1'
   60| 		natural(V) = 10/(PI*(r_e^2))
   61|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 { Cz, 1mA }
   62| 		line to close
   63| 
   64| 	Limited Region 'ELECTRODE2'
   65| 		{ Cz: (0, 0, 9.2) }
   66| 		x_e = 0
   67| 		y_e = 0
   68| 		surface 'ST1'
   69| 		natural(V) = -10/(PI*(r_e^2))
   70| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 {Fz, -1mA}
   71| 		LINE TO CLOSE
   72| 
   73| 
   74| 	Limited Region 3 { arbitrary ground point as a test }
   75| 		{ Ground voltage value between the electrodes }
   76| 		x_e = 6.578/2
   77| 		y_e = 0
   78| 		surface 'ST1'
   79| 		value(V) = 0
   80| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   81| 		line to close
   82| 
   83| 	Limited Region 4 { the skull region }
   84| 		layer 'LT2' sigma = sigma_sk
   85| 		layer 'LB2' sigma = sigma_sk
   86| 			! region in all layers that must merge out:
   87| 			layer 'L3'
   88| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
   89| 		line to close
   90| 
   91| 	Limited Region 5 { the brain region }
   92| 		layer 'L3' sigma = sigma_br
   93| 		start(R_br, 0) arc(center=0,0) ANGLE=360
   94| 		line to close
   95| 
   96| 
   97| PLOTS
   98| 	grid(x,y,z)
   99| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  100| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  101| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  102| 	contour(V) on SURFACE 'ST1'
  103| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  104| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  105| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  106| 
  107| 
  108| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  109| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  110| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  111| 
  112| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  113| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  114| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  115| }
  116| 
  117| 	{ export electrodes data }
  118| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  119| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  120| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  121| 
  122| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  123| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  124| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  125| 	
  126| { bot electrodes }
  127| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  128| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  129| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  130| 
  131| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  132| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  133| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  134| 	
  135| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 1980 MS

SUMMARIZE 11 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R              

Orthomin/DInv ITERATION 241, RNORM=3.93844e-05, XNORM=3.40672, 0 MS/IT 0.0364034 uS/NODE
Orthomin/DInv ITERATION 303, RNORM=7.77196e-09, XNORM=0.00272815, 0 MS/IT 0.0361931 uS/NODE
RMS Spatial Errors  1.507e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:05:17 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.072
   13| 	sigma_sc = 1.7
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8
   17| 	R_br = 6
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 
   25| EQUATIONS
   26|     div(-sigma*grad(V)) = 0
   27| 
   28| EXTRUSION
   29|     { z from low to high }
   30|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   31|         layer 'LB1'
   32| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   33| 		layer 'LB2'
   34| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   35| 		layer 'L3'
   36| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   37| 		layer 'LT2'
   38| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   39| 		layer 'LT1'
   40|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   41| 
   42| BOUNDARIES
   43|     
   44|     surface 'ST1' natural(V) = 0
   45|     surface 'SB1' natural(V) = 0
   46| 	
   47| 	Region 1
   48| 		layer 'LT1' sigma=sigma_sc
   49| 		layer 'LB1' sigma=sigma_sc
   50| 		start(R_sc, 0)
   51| 		arc(center=0,0) angle=360
   52| 		line to close
   53| 
   54| 
   55| 	Limited Region  'ELECTRODE1'
   56| 		{ Fz: (6.578, 0, 6.440) }
   57| 		x_e = 6.578
   58| 		y_e = 0
   59| 		surface 'ST1'
   60| 		natural(V) = 100/(PI*(r_e^2))
   61|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 { Cz, 1mA }
   62| 		line to close
   63| 
   64| 	Limited Region 'ELECTRODE2'
   65| 		{ Cz: (0, 0, 9.2) }
   66| 		x_e = 0
   67| 		y_e = 0
   68| 		surface 'ST1'
   69| 		natural(V) = -100/(PI*(r_e^2))
   70| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 {Fz, -1mA}
   71| 		LINE TO CLOSE
   72| 
   73| 
   74| 	Limited Region 3 { arbitrary ground point as a test }
   75| 		{ Ground voltage value between the electrodes }
   76| 		x_e = 6.578/2
   77| 		y_e = 0
   78| 		surface 'ST1'
   79| 		value(V) = 0
   80| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   81| 		line to close
   82| 
   83| 	Limited Region 4 { the skull region }
   84| 		layer 'LT2' sigma = sigma_sk
   85| 		layer 'LB2' sigma = sigma_sk
   86| 			! region in all layers that must merge out:
   87| 			layer 'L3'
   88| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
   89| 		line to close
   90| 
   91| 	Limited Region 5 { the brain region }
   92| 		layer 'L3' sigma = sigma_br
   93| 		start(R_br, 0) arc(center=0,0) ANGLE=360
   94| 		line to close
   95| 
   96| 
   97| PLOTS
   98| 	grid(x,y,z)
   99| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  100| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  101| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  102| 	contour(V) on SURFACE 'ST1'
  103| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  104| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  105| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  106| 
  107| 
  108| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  109| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  110| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  111| 
  112| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  113| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  114| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  115| }
  116| 
  117| 	{ export electrodes data }
  118| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  119| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  120| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  121| 
  122| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  123| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  124| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  125| 	
  126| { bot electrodes }
  127| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  128| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  129| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  130| 
  131| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  132| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  133| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  134| 	
  135| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 1990 MS

SUMMARIZE 11 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R              

Orthomin/DInv ITERATION 241, RNORM=0.00041232, XNORM=34.0669, 0 MS/IT 0.0364034 uS/NODE
Orthomin/DInv ITERATION 303, RNORM=7.85662e-08, XNORM=0.0290848, 0 MS/IT 0.0337802 uS/NODE
Orthomin/DInv ITERATION 99, RNORM=1.17024e-09, XNORM=6.42211e-06, 0 MS/IT 0.0295394 uS/NODE
RMS Spatial Errors  1.507e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:05:52 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.072
   13| 	sigma_sc = 1.7
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8
   17| 	R_br = 6
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 
   25| EQUATIONS
   26|     div(-sigma*grad(V)) = 0
   27| 
   28| EXTRUSION
   29|     { z from low to high }
   30|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   31|         layer 'LB1'
   32| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   33| 		layer 'LB2'
   34| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   35| 		layer 'L3'
   36| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   37| 		layer 'LT2'
   38| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   39| 		layer 'LT1'
   40|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   41| 
   42| BOUNDARIES
   43|     
   44|     surface 'ST1' natural(V) = 0
   45|     surface 'SB1' natural(V) = 0
   46| 	
   47| 	Region 1
   48| 		layer 'LT1' sigma=sigma_sc
   49| 		layer 'LB1' sigma=sigma_sc
   50| 		start(R_sc, 0)
   51| 		arc(center=0,0) angle=360
   52| 		line to close
   53| 
   54| 
   55| 	Limited Region  'ELECTRODE1'
   56| 		{ Fz: (6.578, 0, 6.440) }
   57| 		x_e = 6.578
   58| 		y_e = 0
   59| 		surface 'ST1'
   60| 		natural(V) = 1/(PI*(r_e^2))
   61|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 { Cz, 1mA }
   62| 		line to close
   63| 
   64| 	Limited Region 'ELECTRODE2'
   65| 		{ Cz: (0, 0, 9.2) }
   66| 		x_e = 0
   67| 		y_e = 0
   68| 		surface 'ST1'
   69| 		natural(V) = -1/(PI*(r_e^2))
   70| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 {Fz, -1mA}
   71| 		LINE TO CLOSE
   72| 
   73| 
   74| 	Limited Region 3 { arbitrary ground point as a test }
   75| 		{ Ground voltage value between the electrodes }
   76| 		x_e = 6.578/2
   77| 		y_e = 0
   78| 		surface 'ST1'
   79| 		value(V) = 0
   80| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   81| 		line to close
   82| 
   83| 	Limited Region 4 { the skull region }
   84| 		layer 'LT2' sigma = sigma_sk
   85| 		layer 'LB2' sigma = sigma_sk
   86| 			! region in all layers that must merge out:
   87| 			layer 'L3'
   88| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
   89| 		line to close
   90| 
   91| 	Limited Region 5 { the brain region }
   92| 		layer 'L3' sigma = sigma_br
   93| 		start(R_br, 0) arc(center=0,0) ANGLE=360
   94| 		line to close
   95| 
   96| 
   97| PLOTS
   98| 	grid(x,y,z)
   99| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  100| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  101| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  102| 	contour(V) on SURFACE 'ST1'
  103| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  104| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  105| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  106| 
  107| 
  108| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  109| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  110| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  111| 
  112| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  113| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  114| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  115| }
  116| 
  117| 	{ export electrodes data }
  118| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  119| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  120| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  121| 
  122| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  123| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  124| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  125| 	
  126| { bot electrodes }
  127| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  128| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  129| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  130| 
  131| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  132| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  133| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  134| 	
  135| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 1980 MS

SUMMARIZE 11 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R              

Orthomin/DInv ITERATION 241, RNORM=4.09286e-06, XNORM=0.340671, 0 MS/IT 0.0333698 uS/NODE
Orthomin/DInv ITERATION 304, RNORM=7.48217e-10, XNORM=0.000280297, 0 MS/IT 0.0336691 uS/NODE
RMS Spatial Errors  1.507e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:07:24 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8
   17| 	R_br = 6
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 
   25| EQUATIONS
   26|     div(-sigma*grad(V)) = 0
   27| 
   28| EXTRUSION
   29|     { z from low to high }
   30|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   31|         layer 'LB1'
   32| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   33| 		layer 'LB2'
   34| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   35| 		layer 'L3'
   36| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   37| 		layer 'LT2'
   38| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   39| 		layer 'LT1'
   40|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   41| 
   42| BOUNDARIES
   43|     
   44|     surface 'ST1' natural(V) = 0
   45|     surface 'SB1' natural(V) = 0
   46| 	
   47| 	Region 1
   48| 		layer 'LT1' sigma=sigma_sc
   49| 		layer 'LB1' sigma=sigma_sc
   50| 		start(R_sc, 0)
   51| 		arc(center=0,0) angle=360
   52| 		line to close
   53| 
   54| 
   55| 	Limited Region  'ELECTRODE1'
   56| 		{ Fz: (6.578, 0, 6.440) }
   57| 		x_e = 6.578
   58| 		y_e = 0
   59| 		surface 'ST1'
   60| 		natural(V) = 1/(PI*(r_e^2))
   61|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 { Cz, 1mA }
   62| 		line to close
   63| 
   64| 	Limited Region 'ELECTRODE2'
   65| 		{ Cz: (0, 0, 9.2) }
   66| 		x_e = 0
   67| 		y_e = 0
   68| 		surface 'ST1'
   69| 		natural(V) = -1/(PI*(r_e^2))
   70| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 {Fz, -1mA}
   71| 		LINE TO CLOSE
   72| 
   73| 
   74| 	Limited Region 3 { arbitrary ground point as a test }
   75| 		{ Ground voltage value between the electrodes }
   76| 		x_e = 6.578/2
   77| 		y_e = 0
   78| 		surface 'ST1'
   79| 		value(V) = 0
   80| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   81| 		line to close
   82| 
   83| 	Limited Region 4 { the skull region }
   84| 		layer 'LT2' sigma = sigma_sk
   85| 		layer 'LB2' sigma = sigma_sk
   86| 			! region in all layers that must merge out:
   87| 			layer 'L3'
   88| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
   89| 		line to close
   90| 
   91| 	Limited Region 5 { the brain region }
   92| 		layer 'L3' sigma = sigma_br
   93| 		start(R_br, 0) arc(center=0,0) ANGLE=360
   94| 		line to close
   95| 
   96| 
   97| PLOTS
   98| 	grid(x,y,z)
   99| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  100| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  101| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  102| 	contour(V) on SURFACE 'ST1'
  103| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  104| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  105| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  106| 
  107| 
  108| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  109| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  110| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  111| 
  112| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  113| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  114| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  115| }
  116| 
  117| 	{ export electrodes data }
  118| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  119| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  120| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  121| 
  122| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  123| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  124| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  125| 	
  126| { bot electrodes }
  127| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  128| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  129| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  130| 
  131| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  132| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  133| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  134| 	
  135| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 1980 MS

SUMMARIZE 11 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R              

Orthomin/DInv ITERATION 273, RNORM=2.30748e-06, XNORM=0.185416, 0 MS/IT 0.0374924 uS/NODE
Orthomin/DInv ITERATION 322, RNORM=4.88009e-10, XNORM=0.000135793, 0 MS/IT 0.036328 uS/NODE
RMS Spatial Errors  1.545e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:09:33 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8
   17| 	R_br = 6
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.25	 { 1cm diameter electrode }
   24| 
   25| EQUATIONS
   26|     div(-sigma*grad(V)) = 0
   27| 
   28| EXTRUSION
   29|     { z from low to high }
   30|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   31|         layer 'LB1'
   32| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   33| 		layer 'LB2'
   34| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   35| 		layer 'L3'
   36| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   37| 		layer 'LT2'
   38| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   39| 		layer 'LT1'
   40|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   41| 
   42| BOUNDARIES
   43|     
   44|     surface 'ST1' natural(V) = 0
   45|     surface 'SB1' natural(V) = 0
   46| 	
   47| 	Region 1
   48| 		layer 'LT1' sigma=sigma_sc
   49| 		layer 'LB1' sigma=sigma_sc
   50| 		start(R_sc, 0)
   51| 		arc(center=0,0) angle=360
   52| 		line to close
   53| 
   54| 
   55| 	Limited Region  'ELECTRODE1'
   56| 		{ Fz: (6.578, 0, 6.440) }
   57| 		x_e = 6.578
   58| 		y_e = 0
   59| 		surface 'ST1'
   60| 		natural(V) = 1/(PI*(r_e^2))
   61|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 { Cz, 1mA }
   62| 		line to close
   63| 
   64| 	Limited Region 'ELECTRODE2'
   65| 		{ Cz: (0, 0, 9.2) }
   66| 		x_e = 0
   67| 		y_e = 0
   68| 		surface 'ST1'
   69| 		natural(V) = -1/(PI*(r_e^2))
   70| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 {Fz, -1mA}
   71| 		LINE TO CLOSE
   72| 
   73| 
   74| 	Limited Region 3 { arbitrary ground point as a test }
   75| 		{ Ground voltage value between the electrodes }
   76| 		x_e = 6.578/2
   77| 		y_e = 0
   78| 		surface 'ST1'
   79| 		value(V) = 0
   80| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   81| 		line to close
   82| 
   83| 	Limited Region 4 { the skull region }
   84| 		layer 'LT2' sigma = sigma_sk
   85| 		layer 'LB2' sigma = sigma_sk
   86| 			! region in all layers that must merge out:
   87| 			layer 'L3'
   88| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
   89| 		line to close
   90| 
   91| 	Limited Region 5 { the brain region }
   92| 		layer 'L3' sigma = sigma_br
   93| 		start(R_br, 0) arc(center=0,0) ANGLE=360
   94| 		line to close
   95| 
   96| 
   97| PLOTS
   98| 	grid(x,y,z)
   99| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  100| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  101| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  102| 	contour(V) on SURFACE 'ST1'
  103| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  104| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  105| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  106| 
  107| 
  108| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  109| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  110| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  111| 
  112| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  113| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  114| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  115| }
  116| 
  117| 	{ export electrodes data }
  118| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  119| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  120| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  121| 
  122| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  123| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  124| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  125| 	
  126| { bot electrodes }
  127| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  128| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  129| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  130| 
  131| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  132| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  133| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  134| 	
  135| end
SUBDIVIDE 735
SUBDIVIDE 899
SUBDIVIDE 901
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1
STRETCH_MESH3 TIME = 20 MS

3D MESH GENERATION TIME 3330 MS

SUMMARIZE 11 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R              

Orthomin/ILU ITERATION 90, RNORM=8.90299e-07, XNORM=0.146486, 2 MS/IT 0.130093 uS/NODE
Orthomin/ILU ITERATION 66, RNORM=4.12097e-10, XNORM=4.17145e-05, 2 MS/IT 0.137081 uS/NODE
RMS Spatial Errors  4.427e-5
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:10:14 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8
   17| 	R_br = 6
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 
   25| EQUATIONS
   26|     div(-sigma*grad(V)) = 0
   27| 
   28| EXTRUSION
   29|     { z from low to high }
   30|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   31|         layer 'LB1'
   32| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   33| 		layer 'LB2'
   34| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   35| 		layer 'L3'
   36| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   37| 		layer 'LT2'
   38| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   39| 		layer 'LT1'
   40|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   41| 
   42| BOUNDARIES
   43|     
   44|     surface 'ST1' natural(V) = 0
   45|     surface 'SB1' natural(V) = 0
   46| 	
   47| 	Region 1
   48| 		layer 'LT1' sigma=sigma_sc
   49| 		layer 'LB1' sigma=sigma_sc
   50| 		start(R_sc, 0)
   51| 		arc(center=0,0) angle=360
   52| 		line to close
   53| 
   54| 
   55| 	Limited Region  'ELECTRODE1'
   56| 		{ Fz: (6.578, 0, 6.440) }
   57| 		x_e = 6.578
   58| 		y_e = 0
   59| 		surface 'ST1'
   60| 		natural(V) = 1/(PI*(r_e^2))
   61|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 { Cz, 1mA }
   62| 		line to close
   63| 
   64| 	Limited Region 'ELECTRODE2'
   65| 		{ Cz: (0, 0, 9.2) }
   66| 		x_e = 0
   67| 		y_e = 0
   68| 		surface 'ST1'
   69| 		natural(V) = -1/(PI*(r_e^2))
   70| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 {Fz, -1mA}
   71| 		LINE TO CLOSE
   72| 
   73| 
   74| 	Limited Region 3 { arbitrary ground point as a test }
   75| 		{ Ground voltage value between the electrodes }
   76| 		x_e = 6.578/2
   77| 		y_e = 0
   78| 		surface 'ST1'
   79| 		value(V) = 0
   80| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   81| 		line to close
   82| 
   83| 	Limited Region 4 { the skull region }
   84| 		layer 'LT2' sigma = sigma_sk
   85| 		layer 'LB2' sigma = sigma_sk
   86| 			! region in all layers that must merge out:
   87| 			layer 'L3'
   88| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
   89| 		line to close
   90| 
   91| 	Limited Region 5 { the brain region }
   92| 		layer 'L3' sigma = sigma_br
   93| 		start(R_br, 0) arc(center=0,0) ANGLE=360
   94| 		line to close
   95| 
   96| 
   97| PLOTS
   98| 	grid(x,y,z)
   99| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  100| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  101| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  102| 	contour(V) on SURFACE 'ST1'
  103| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  104| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  105| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  106| 
  107| 
  108| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  109| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  110| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  111| 
  112| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  113| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  114| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  115| }
  116| 
  117| 	{ export electrodes data }
  118| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  119| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  120| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  121| 
  122| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  123| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  124| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  125| 	
  126| { bot electrodes }
  127| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  128| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  129| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  130| 
  131| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  132| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  133| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  134| 	
  135| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 1960 MS

SUMMARIZE 11 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R              

Orthomin/DInv ITERATION 273, RNORM=2.30748e-06, XNORM=0.185416, 0 MS/IT 0.0374924 uS/NODE
Orthomin/DInv ITERATION 322, RNORM=4.88009e-10, XNORM=0.000135793, 0 MS/IT 0.036328 uS/NODE
RMS Spatial Errors  1.545e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:11:24 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 
   25| EQUATIONS
   26|     div(-sigma*grad(V)) = 0
   27| 
   28| EXTRUSION
   29|     { z from low to high }
   30|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   31|         layer 'LB1'
   32| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   33| 		layer 'LB2'
   34| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   35| 		layer 'L3'
   36| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   37| 		layer 'LT2'
   38| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   39| 		layer 'LT1'
   40|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   41| 
   42| BOUNDARIES
   43|     
   44|     surface 'ST1' natural(V) = 0
   45|     surface 'SB1' natural(V) = 0
   46| 	
   47| 	Region 1
   48| 		layer 'LT1' sigma=sigma_sc
   49| 		layer 'LB1' sigma=sigma_sc
   50| 		start(R_sc, 0)
   51| 		arc(center=0,0) angle=360
   52| 		line to close
   53| 
   54| 
   55| 	Limited Region  'ELECTRODE1'
   56| 		{ Fz: (6.578, 0, 6.440) }
   57| 		x_e = 6.578
   58| 		y_e = 0
   59| 		surface 'ST1'
   60| 		natural(V) = 1/(PI*(r_e^2))
   61|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 { Cz, 1mA }
   62| 		line to close
   63| 
   64| 	Limited Region 'ELECTRODE2'
   65| 		{ Cz: (0, 0, 9.2) }
   66| 		x_e = 0
   67| 		y_e = 0
   68| 		surface 'ST1'
   69| 		natural(V) = -1/(PI*(r_e^2))
   70| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 {Fz, -1mA}
   71| 		LINE TO CLOSE
   72| 
   73| 
   74| 	Limited Region 3 { arbitrary ground point as a test }
   75| 		{ Ground voltage value between the electrodes }
   76| 		x_e = 6.578/2
   77| 		y_e = 0
   78| 		surface 'ST1'
   79| 		value(V) = 0
   80| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   81| 		line to close
   82| 
   83| 	Limited Region 4 { the skull region }
   84| 		layer 'LT2' sigma = sigma_sk
   85| 		layer 'LB2' sigma = sigma_sk
   86| 			! region in all layers that must merge out:
   87| 			layer 'L3'
   88| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
   89| 		line to close
   90| 
   91| 	Limited Region 5 { the brain region }
   92| 		layer 'L3' sigma = sigma_br
   93| 		start(R_br, 0) arc(center=0,0) ANGLE=360
   94| 		line to close
   95| 
   96| 
   97| PLOTS
   98| 	grid(x,y,z)
   99| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  100| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  101| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  102| 	contour(V) on SURFACE 'ST1'
  103| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  104| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  105| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  106| 
  107| 
  108| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  109| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  110| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  111| 
  112| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  113| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  114| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  115| }
  116| 
  117| 	{ export electrodes data }
  118| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  119| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  120| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  121| 
  122| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  123| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  124| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  125| 	
  126| { bot electrodes }
  127| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  128| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  129| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  130| 
  131| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  132| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  133| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  134| 	
  135| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2610 MS

SUMMARIZE 11 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R              

Orthomin/DInv ITERATION 338, RNORM=9.61524e-06, XNORM=0.235214, 0 MS/IT 0.0399182 uS/NODE
Orthomin/DInv ITERATION 446, RNORM=5.25155e-10, XNORM=0.000242329, 0 MS/IT 0.0375124 uS/NODE
RMS Spatial Errors  1.360e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:18:31 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 	{ electrode positions }
   25| 	{ Fc1 }
   26| 	x_Fc1 = 3.511
   27| 	y_Fc1 = 3.502
   28| 	{ Fc2 }
   29| 	x_Fc2 = 3.511
   30| 	y_Fc2 = -3.502
   31| 	{ Cp1 }
   32| 	x_Cp1 = -3.510
   33| 	y_Cp1 = 3.502
   34| 	{ Cp2 }
   35| 	x_Cp2 = -3.510
   36| 	y_Cp2 = -3.502
   37| 	{ C3 }
   38| 	x_C3 = 0
   39| 	y_C3 = -6.837
   40| 	{ C4 }
   41| 	x_C4 = 0
   42| 	y_C4 = -6.837
   43| 
   44| 
   45| EQUATIONS
   46|     div(-sigma*grad(V)) = 0
   47| 
   48| EXTRUSION
   49|     { z from low to high }
   50|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   51|         layer 'LB1'
   52| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   53| 		layer 'LB2'
   54| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   55| 		layer 'L3'
   56| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   57| 		layer 'LT2'
   58| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   59| 		layer 'LT1'
   60|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   61| 
   62| BOUNDARIES
   63|     
   64|     surface 'ST1' natural(V) = 0
   65|     surface 'SB1' natural(V) = 0
   66| 	
   67| 	Region 1
   68| 		layer 'LT1' sigma=sigma_sc
   69| 		layer 'LB1' sigma=sigma_sc
   70| 		start(R_sc, 0)
   71| 		arc(center=0,0) angle=360
   72| 		line to close
   73| 
   74| 
   75| 	Limited Region  'ELECTRODE1'
   76| 		x_e = x_Fc1
   77| 		y_e = y_Fc1
   78| 		surface 'ST1'
   79| 		natural(V) = 1/(PI*(r_e^2))
   80|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 
   81| 		line to close
   82| 
   83| 	Limited Region 'ELECTRODE2'
   84| 		x_e = x_Fc2
   85| 		y_e = y_Fc2
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 {Fz, -1mA}
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| 	Limited Region 3 { arbitrary ground point as a test }
   93| 		{ Ground voltage value between the electrodes }
   94| 		x_e = (x_Fc1+x_Fc2)/2
   95| 		y_e = (y_Fc1+y_Fc2)/2
   96| 		surface 'ST1'
   97| 		value(V) = 0
   98| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   99| 		line to close
  100| 
  101| 	Limited Region 4 { the skull region }
  102| 		layer 'LT2' sigma = sigma_sk
  103| 		layer 'LB2' sigma = sigma_sk
  104| 			! region in all layers that must merge out:
  105| 			layer 'L3'
  106| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  107| 		line to close
  108| 
  109| 	Limited Region 5 { the brain region }
  110| 		layer 'L3' sigma = sigma_br
  111| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  112| 		line to close
  113| 
  114| 
  115| PLOTS
  116| 	grid(x,y,z)
  117| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  118| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  119| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  120| 	contour(V) on SURFACE 'ST1'
  121| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  122| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  123| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  124| 
  125| 
  126| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  127| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  128| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  129| 
  130| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  131| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  132| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  133| }
  134| 
  135| 	{ export electrodes data }
  136| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  137| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  138| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  139| 
  140| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  141| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  142| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Cz_Fz_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  143| 	
  144| { bot electrodes }
  145| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  146| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  147| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  148| 
  149| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  150| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  151| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Cz_Fz_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  152| 	
  153| end
SUBDIVIDE 954
SUBDIVIDE 582
SUBDIVIDE 583
SUBDIVIDE 954
SUBDIVIDE 955
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2820 MS

SUMMARIZE 23 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 46, RNORM=8.84227e-07, XNORM=0.0440873, 2 MS/IT 0.131023 uS/NODE
Orthomin/ILU ITERATION 85, RNORM=2.41464e-10, XNORM=0.000265329, 2 MS/IT 0.128921 uS/NODE
RMS Spatial Errors  1.255e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:28:00 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 	{ electrode positions }
   25| 	{ Fc1 }
   26| 	x_Fc1 = 3.511
   27| 	y_Fc1 = 3.502
   28| 	{ Fc2 }
   29| 	x_Fc2 = 3.511
   30| 	y_Fc2 = -3.502
   31| 	{ Cp1 }
   32| 	x_Cp1 = -3.510
   33| 	y_Cp1 = 3.502
   34| 	{ Cp2 }
   35| 	x_Cp2 = -3.510
   36| 	y_Cp2 = -3.502
   37| 	{ C3 }
   38| 	x_C3 = 0
   39| 	y_C3 = -6.837
   40| 	{ C4 }
   41| 	x_C4 = 0
   42| 	y_C4 = -6.837
   43| 
   44| 
   45| EQUATIONS
   46|     div(-sigma*grad(V)) = 0
   47| 
   48| EXTRUSION
   49|     { z from low to high }
   50|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   51|         layer 'LB1'
   52| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   53| 		layer 'LB2'
   54| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   55| 		layer 'L3'
   56| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   57| 		layer 'LT2'
   58| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   59| 		layer 'LT1'
   60|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   61| 
   62| BOUNDARIES
   63|     
   64|     surface 'ST1' natural(V) = 0
   65|     surface 'SB1' natural(V) = 0
   66| 	
   67| 	Region 1
   68| 		layer 'LT1' sigma=sigma_sc
   69| 		layer 'LB1' sigma=sigma_sc
   70| 		start(R_sc, 0)
   71| 		arc(center=0,0) angle=360
   72| 		line to close
   73| 
   74| 
   75| 	Limited Region  'ELECTRODE1'
   76| 		x_e = x_Fc1
   77| 		y_e = y_Fc1
   78| 		surface 'ST1'
   79| 		natural(V) = 1/(PI*(r_e^2))
   80|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 
   81| 		line to close
   82| 
   83| 	Limited Region 'ELECTRODE2'
   84| 		x_e = x_Fc2
   85| 		y_e = y_Fc2
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 {Fz, -1mA}
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| 	Limited Region 3 { arbitrary ground point as a test }
   93| 		{ Ground voltage value between the electrodes }
   94| 		x_e = (x_Fc1+x_Fc2)/2
   95| 		y_e = (y_Fc1+y_Fc2)/2
   96| 		surface 'ST1'
   97| 		value(V) = 0
   98| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   99| 		line to close
  100| 
  101| 	Limited Region 4 { the skull region }
  102| 		layer 'LT2' sigma = sigma_sk
  103| 		layer 'LB2' sigma = sigma_sk
  104| 			! region in all layers that must merge out:
  105| 			layer 'L3'
  106| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  107| 		line to close
  108| 
  109| 	Limited Region 5 { the brain region }
  110| 		layer 'L3' sigma = sigma_br
  111| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  112| 		line to close
  113| 
  114| 
  115| PLOTS
  116| 	grid(x,y,z)
  117| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  118| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  119| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  120| 	contour(V) on SURFACE 'ST1'
  121| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  122| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  123| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  124| 
  125| 
  126| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  127| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  128| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  129| 
  130| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  131| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  132| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  133| }
  134| 
  135| 	{ export electrodes data }
  136| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair1_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  137| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair1_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  138| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair1_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  139| 
  140| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair1_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  141| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair1_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  142| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair1_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  143| 	
  144| { bot electrodes }
  145| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair1_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  146| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair1_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  147| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair1_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  148| 
  149| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair1_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  150| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair1_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  151| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair1_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  152| 	
  153| end
SUBDIVIDE 954
SUBDIVIDE 582
SUBDIVIDE 583
SUBDIVIDE 954
SUBDIVIDE 955
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2800 MS

SUMMARIZE 23 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 46, RNORM=8.84227e-07, XNORM=0.0440873, 2 MS/IT 0.131023 uS/NODE
Orthomin/ILU ITERATION 85, RNORM=2.41464e-10, XNORM=0.000265329, 2 MS/IT 0.135367 uS/NODE
RMS Spatial Errors  1.255e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:31:14 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 	{ electrode positions }
   25| 	{ Fc1 }
   26| 	x_Fc1 = 3.511
   27| 	y_Fc1 = 3.502
   28| 	{ Fc2 }
   29| 	x_Fc2 = 3.511
   30| 	y_Fc2 = -3.502
   31| 	{ Cp1 }
   32| 	x_Cp1 = -3.510
   33| 	y_Cp1 = 3.502
   34| 	{ Cp2 }
   35| 	x_Cp2 = -3.510
   36| 	y_Cp2 = -3.502
   37| 	{ C3 }
   38| 	x_C3 = 0
   39| 	y_C3 = -6.837
   40| 	{ C4 }
   41| 	x_C4 = 0
   42| 	y_C4 = -6.837
   43| 
   44| 
   45| EQUATIONS
   46|     div(-sigma*grad(V)) = 0
   47| 
   48| EXTRUSION
   49|     { z from low to high }
   50|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   51|         layer 'LB1'
   52| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   53| 		layer 'LB2'
   54| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   55| 		layer 'L3'
   56| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   57| 		layer 'LT2'
   58| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   59| 		layer 'LT1'
   60|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   61| 
   62| BOUNDARIES
   63|     
   64|     surface 'ST1' natural(V) = 0
   65|     surface 'SB1' natural(V) = 0
   66| 	
   67| 	Region 1
   68| 		layer 'LT1' sigma=sigma_sc
   69| 		layer 'LB1' sigma=sigma_sc
   70| 		start(R_sc, 0)
   71| 		arc(center=0,0) angle=360
   72| 		line to close
   73| 
   74| 
   75| 	Limited Region  'ELECTRODE1'
   76| 		x_e = x_Fc1
   77| 		y_e = y_Fc1
   78| 		surface 'ST1'
   79| 		natural(V) = 1/(PI*(r_e^2))
   80|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 
   81| 		line to close
   82| 
   83| 	Limited Region 'ELECTRODE2'
   84| 		x_e = x_Fc2
   85| 		y_e = y_Fc2
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 {Fz, -1mA}
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| 	Limited Region 3 { arbitrary ground point as a test }
   93| 		{ Ground voltage value between the electrodes }
   94| 		x_e = (x_Fc1+x_Fc2)/2
   95| 		y_e = (y_Fc1+y_Fc2)/2
   96| 		surface 'ST1'
   97| 		value(V) = 0
   98| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   99| 		line to close
  100| 
  101| 	Limited Region 4 { the skull region }
  102| 		layer 'LT2' sigma = sigma_sk
  103| 		layer 'LB2' sigma = sigma_sk
  104| 		surface 'SB2' sigma = sigma_sk
ERROR in state 357: GOT: 2(<identifier>) WANTED: 15(<plus>)
***** Line 104 Col 22:
FlexPDE grammar does not allow '<identifier>' in this location.


================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:31:54 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 	{ electrode positions }
   25| 	{ Fc1 }
   26| 	x_Fc1 = 3.511
   27| 	y_Fc1 = 3.502
   28| 	{ Fc2 }
   29| 	x_Fc2 = 3.511
   30| 	y_Fc2 = -3.502
   31| 	{ Cp1 }
   32| 	x_Cp1 = -3.510
   33| 	y_Cp1 = 3.502
   34| 	{ Cp2 }
   35| 	x_Cp2 = -3.510
   36| 	y_Cp2 = -3.502
   37| 	{ C3 }
   38| 	x_C3 = 0
   39| 	y_C3 = -6.837
   40| 	{ C4 }
   41| 	x_C4 = 0
   42| 	y_C4 = -6.837
   43| 
   44| 
   45| EQUATIONS
   46|     div(-sigma*grad(V)) = 0
   47| 
   48| EXTRUSION
   49|     { z from low to high }
   50|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   51|         layer 'LB1'
   52| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   53| 		layer 'LB2'
   54| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   55| 		layer 'L3'
   56| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   57| 		layer 'LT2'
   58| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   59| 		layer 'LT1'
   60|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   61| 
   62| BOUNDARIES
   63|     
   64|     surface 'ST1' natural(V) = 0
   65|     surface 'SB1' natural(V) = 0
   66| 	
   67| 	Region 1
   68| 		layer 'LT1' sigma=sigma_sc
   69| 		layer 'LB1' sigma=sigma_sc
   70| 		start(R_sc, 0)
   71| 		arc(center=0,0) angle=360
   72| 		line to close
   73| 
   74| 
   75| 	Limited Region  'ELECTRODE1'
   76| 		x_e = x_Fc1
   77| 		y_e = y_Fc1
   78| 		surface 'ST1'
   79| 		natural(V) = 1/(PI*(r_e^2))
   80|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 
   81| 		line to close
   82| 
   83| 	Limited Region 'ELECTRODE2'
   84| 		x_e = x_Fc2
   85| 		y_e = y_Fc2
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 {Fz, -1mA}
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| 	Limited Region 3 { arbitrary ground point as a test }
   93| 		{ Ground voltage value between the electrodes }
   94| 		x_e = (x_Fc1+x_Fc2)/2
   95| 		y_e = (y_Fc1+y_Fc2)/2
   96| 		surface 'ST1'
   97| 		value(V) = 0
   98| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   99| 		line to close
  100| 
  101| 	Limited Region 4 { the skull region }
  102| 		layer 'LT2' sigma = sigma_sk
  103| 		layer 'LB2' sigma = sigma_sk
  104| 		surface 'SB2' sigma = sigma_sk
ERROR in state 357: GOT: 2(<identifier>) WANTED: 15(<plus>)
***** Line 104 Col 22:
FlexPDE grammar does not allow '<identifier>' in this location.


================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:32:02 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 	{ electrode positions }
   25| 	{ Fc1 }
   26| 	x_Fc1 = 3.511
   27| 	y_Fc1 = 3.502
   28| 	{ Fc2 }
   29| 	x_Fc2 = 3.511
   30| 	y_Fc2 = -3.502
   31| 	{ Cp1 }
   32| 	x_Cp1 = -3.510
   33| 	y_Cp1 = 3.502
   34| 	{ Cp2 }
   35| 	x_Cp2 = -3.510
   36| 	y_Cp2 = -3.502
   37| 	{ C3 }
   38| 	x_C3 = 0
   39| 	y_C3 = -6.837
   40| 	{ C4 }
   41| 	x_C4 = 0
   42| 	y_C4 = -6.837
   43| 
   44| 
   45| EQUATIONS
   46|     div(-sigma*grad(V)) = 0
   47| 
   48| EXTRUSION
   49|     { z from low to high }
   50|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   51|         layer 'LB1'
   52| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   53| 		layer 'LB2'
   54| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   55| 		layer 'L3'
   56| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   57| 		layer 'LT2'
   58| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   59| 		layer 'LT1'
   60|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   61| 
   62| BOUNDARIES
   63|     
   64|     surface 'ST1' natural(V) = 0
   65|     surface 'SB1' natural(V) = 0
   66| 	
   67| 	Region 1
   68| 		layer 'LT1' sigma=sigma_sc
   69| 		layer 'LB1' sigma=sigma_sc
   70| 		start(R_sc, 0)
   71| 		arc(center=0,0) angle=360
   72| 		line to close
   73| 
   74| 
   75| 	Limited Region  'ELECTRODE1'
   76| 		x_e = x_Fc1
   77| 		y_e = y_Fc1
   78| 		surface 'ST1'
   79| 		natural(V) = 1/(PI*(r_e^2))
   80|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 
   81| 		line to close
   82| 
   83| 	Limited Region 'ELECTRODE2'
   84| 		x_e = x_Fc2
   85| 		y_e = y_Fc2
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 {Fz, -1mA}
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| 	Limited Region 3 { arbitrary ground point as a test }
   93| 		{ Ground voltage value between the electrodes }
   94| 		x_e = (x_Fc1+x_Fc2)/2
   95| 		y_e = (y_Fc1+y_Fc2)/2
   96| 		surface 'ST1'
   97| 		value(V) = 0
   98| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   99| 		line to close
  100| 
  101| 	Limited Region 4 { the skull region }
  102| 		layer 'LT2' sigma = sigma_sk
  103| 		layer 'LB2' sigma = sigma_sk
  104| 		surface 'SB2' sigma = sigma_sk
ERROR in state 357: GOT: 2(<identifier>) WANTED: 15(<plus>)
***** Line 104 Col 22:
FlexPDE grammar does not allow '<identifier>' in this location.


================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:33:35 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 	{ electrode positions }
   25| 	{ Fc1 }
   26| 	x_Fc1 = 3.511
   27| 	y_Fc1 = 3.502
   28| 	{ Fc2 }
   29| 	x_Fc2 = 3.511
   30| 	y_Fc2 = -3.502
   31| 	{ Cp1 }
   32| 	x_Cp1 = -3.510
   33| 	y_Cp1 = 3.502
   34| 	{ Cp2 }
   35| 	x_Cp2 = -3.510
   36| 	y_Cp2 = -3.502
   37| 	{ C3 }
   38| 	x_C3 = 0
   39| 	y_C3 = -6.837
   40| 	{ C4 }
   41| 	x_C4 = 0
   42| 	y_C4 = -6.837
   43| 
   44| 
   45| EQUATIONS
   46|     div(-sigma*grad(V)) = 0
   47| 
   48| EXTRUSION
   49|     { z from low to high }
   50|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   51|         layer 'LB1'
   52| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   53| 		layer 'LB2'
   54| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   55| 		layer 'L3'
   56| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   57| 		layer 'LT2'
   58| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   59| 		layer 'LT1'
   60|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   61| 
   62| BOUNDARIES
   63|     
   64|     surface 'ST1' natural(V) = 0
   65|     surface 'SB1' natural(V) = 0
   66| 	
   67| 	Region 1
   68| 		layer 'LT1' sigma=sigma_sc
   69| 		layer 'LB1' sigma=sigma_sc
   70| 		start(R_sc, 0)
   71| 		arc(center=0,0) angle=360
   72| 		line to close
   73| 
   74| 
   75| 	Limited Region  'ELECTRODE1'
   76| 		x_e = x_Fc1
   77| 		y_e = y_Fc1
   78| 		surface 'ST1'
   79| 		natural(V) = 1/(PI*(r_e^2))
   80|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 
   81| 		line to close
   82| 
   83| 	Limited Region 'ELECTRODE2'
   84| 		x_e = x_Cp1
   85| 		y_e = y_Cp1
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| 	Limited Region 3 { arbitrary ground point as a test }
   93| 		{ Ground voltage value between the electrodes }
   94| 		x_e = (x_Fc1+x_Cp1)/2
   95| 		y_e = (y_Fc1+y_Cp1)/2
   96| 		surface 'ST1'
   97| 		value(V) = 0
   98| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   99| 		line to close
  100| 
  101| 	Limited Region 4 { the skull region }
  102| 		layer 'LT2' sigma = sigma_sk
  103| 		layer 'LB2' sigma = sigma_sk
  104| 			! region in all layers that must merge out:
  105| 			layer 'L3'
  106| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  107| 		line to close
  108| 
  109| 	Limited Region 5 { the brain region }
  110| 		layer 'L3' sigma = sigma_br
  111| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  112| 		line to close
  113| 
  114| 
  115| PLOTS
  116| 	grid(x,y,z)
  117| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  118| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  119| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  120| 	contour(V) on SURFACE 'ST1'
  121| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  122| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  123| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  124| 
  125| 
  126| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  127| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  128| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  129| 
  130| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  131| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  132| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  133| }
  134| 
  135| 	{ export electrodes data }
  136| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair2_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  137| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair2_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  138| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair2_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  139| 
  140| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair2_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  141| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair2_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  142| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair2_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  143| 	
  144| { bot electrodes }
  145| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair2_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  146| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair2_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  147| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair2_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  148| 
  149| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair2_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  150| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair2_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  151| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair2_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  152| 	
  153| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2670 MS

SUMMARIZE 23 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 46, RNORM=1.65307e-06, XNORM=0.0440633, 2 MS/IT 0.141102 uS/NODE
Orthomin/ILU ITERATION 88, RNORM=3.66417e-10, XNORM=0.000336137, 2 MS/IT 0.129076 uS/NODE
RMS Spatial Errors  1.220e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:38:54 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 	{ electrode positions }
   25| 	{ Fc1 }
   26| 	x_Fc1 = 3.511
   27| 	y_Fc1 = 3.502
   28| 	{ Fc2 }
   29| 	x_Fc2 = 3.511
   30| 	y_Fc2 = -3.502
   31| 	{ Cp1 }
   32| 	x_Cp1 = -3.510
   33| 	y_Cp1 = 3.502
   34| 	{ Cp2 }
   35| 	x_Cp2 = -3.510
   36| 	y_Cp2 = -3.502
   37| 	{ C3 }
   38| 	x_C3 = 0
   39| 	y_C3 = -6.837
   40| 	{ C4 }
   41| 	x_C4 = 0
   42| 	y_C4 = -6.837
   43| 
   44| 
   45| EQUATIONS
   46|     div(-sigma*grad(V)) = 0
   47| 
   48| EXTRUSION
   49|     { z from low to high }
   50|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   51|         layer 'LB1'
   52| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   53| 		layer 'LB2'
   54| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   55| 		layer 'L3'
   56| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   57| 		layer 'LT2'
   58| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   59| 		layer 'LT1'
   60|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   61| 
   62| BOUNDARIES
   63|     
   64|     surface 'ST1' natural(V) = 0
   65|     surface 'SB1' natural(V) = 0
   66| 	
   67| 	Region 1
   68| 		layer 'LT1' sigma=sigma_sc
   69| 		layer 'LB1' sigma=sigma_sc
   70| 		start(R_sc, 0)
   71| 		arc(center=0,0) angle=360
   72| 		line to close
   73| 
   74| 
   75| 	Limited Region  'ELECTRODE1'
   76| 		x_e = x_Fc1
   77| 		y_e = y_Fc1
   78| 		surface 'ST1'
   79| 		natural(V) = 1/(PI*(r_e^2))
   80|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 
   81| 		line to close
   82| 
   83| 	Limited Region 'ELECTRODE2'
   84| 		x_e = x_Cp2
   85| 		y_e = y_Cp2
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| 	Limited Region 3 { arbitrary ground point as a test }
   93| 		{ Ground voltage value between the electrodes }
   94| 		x_e = (x_Fc1+x_Cp2)/2
   95| 		y_e = (y_Fc1+y_Cp2)/2
   96| 		surface 'ST1'
   97| 		value(V) = 0
   98| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
   99| 		line to close
  100| 
  101| 	Limited Region 4 { the skull region }
  102| 		layer 'LT2' sigma = sigma_sk
  103| 		layer 'LB2' sigma = sigma_sk
  104| 			! region in all layers that must merge out:
  105| 			layer 'L3'
  106| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  107| 		line to close
  108| 
  109| 	Limited Region 5 { the brain region }
  110| 		layer 'L3' sigma = sigma_br
  111| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  112| 		line to close
  113| 
  114| 
  115| PLOTS
  116| 	grid(x,y,z)
  117| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  118| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  119| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  120| 	contour(V) on SURFACE 'ST1'
  121| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  122| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  123| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  124| 
  125| 
  126| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  127| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  128| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  129| 
  130| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  131| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  132| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  133| }
  134| 
  135| 	{ export electrodes data }
  136| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair3_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  137| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair3_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  138| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair3_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  139| 
  140| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair3_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  141| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair3_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  142| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair3_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  143| 	
  144| { bot electrodes }
  145| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair3_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  146| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair3_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  147| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair3_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  148| 
  149| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair3_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  150| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair3_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  151| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair3_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  152| 	
  153| end
SUBDIVIDE 444
SUBDIVIDE 1013
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
STRETCH_MESH3 TIME = 10 MS
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2850 MS

SUMMARIZE 23 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 46, RNORM=3.61636e-07, XNORM=0.0489266, 2 MS/IT 0.126344 uS/NODE
Orthomin/ILU ITERATION 91, RNORM=1.0147e-10, XNORM=7.92575e-05, 2 MS/IT 0.133538 uS/NODE
RMS Spatial Errors  1.282e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:40:48 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 	{ electrode positions }
   25| 	{ Fc1 }
   26| 	x_Fc1 = 3.511
   27| 	y_Fc1 = 3.502
   28| 	{ Fc2 }
   29| 	x_Fc2 = 3.511
   30| 	y_Fc2 = -3.502
   31| 	{ Cp1 }
   32| 	x_Cp1 = -3.510
   33| 	y_Cp1 = 3.502
   34| 	{ Cp2 }
   35| 	x_Cp2 = -3.510
   36| 	y_Cp2 = -3.502
   37| 	{ C3 }
   38| 	x_C3 = 0
   39| 	y_C3 = -6.837
   40| 	{ C4 }
   41| 	x_C4 = 0
   42| 	y_C4 = -6.837
   43| 
   44| 
   45| EQUATIONS
   46|     div(-sigma*grad(V)) = 0
   47| 
   48| EXTRUSION
   49|     { z from low to high }
   50|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   51|         layer 'LB1'
   52| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   53| 		layer 'LB2'
   54| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   55| 		layer 'L3'
   56| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   57| 		layer 'LT2'
   58| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   59| 		layer 'LT1'
   60|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   61| 
   62| BOUNDARIES
   63|     
   64|     surface 'ST1' natural(V) = 0
   65|     surface 'SB1' natural(V) = 0
   66| 	
   67| 	Region 1
   68| 		layer 'LT1' sigma=sigma_sc
   69| 		layer 'LB1' sigma=sigma_sc
   70| 		start(R_sc, 0)
   71| 		arc(center=0,0) angle=360
   72| 		line to close
   73| 
   74| { Electrode 1 }
   75| 	Limited Region  'ELECTRODE1'
   76| 		x_e = x_Fc1
   77| 		y_e = y_Fc1
   78| 		surface 'ST1'
   79| 		natural(V) = 1/(PI*(r_e^2))
   80|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 
   81| 		line to close
   82| 
   83| { Electrode 2 }
   84| 	Limited Region 'ELECTRODE2'
   85| 		x_e = x_C3
   86| 		y_e = y_C3
   87| 		surface 'ST1'
   88| 		natural(V) = -1/(PI*(r_e^2))
   89| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 
   90| 		LINE TO CLOSE
   91| 
   92| 
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		x_e = (x_Fc1+x_C3)/2
   96| 		y_e = (y_Fc1+y_C3)/2
   97| 		surface 'ST1'
   98| 		value(V) = 0
   99| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
  100| 		line to close
  101| 
  102| 	Limited Region 4 { the skull region }
  103| 		layer 'LT2' sigma = sigma_sk
  104| 		layer 'LB2' sigma = sigma_sk
  105| 			! region in all layers that must merge out:
  106| 			layer 'L3'
  107| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  108| 		line to close
  109| 
  110| 	Limited Region 5 { the brain region }
  111| 		layer 'L3' sigma = sigma_br
  112| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  113| 		line to close
  114| 
  115| 
  116| PLOTS
  117| 	grid(x,y,z)
  118| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  119| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  120| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  121| 	contour(V) on SURFACE 'ST1'
  122| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  123| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  124| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  125| 
  126| 
  127| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  128| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  129| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  130| 
  131| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  132| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  133| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  134| }
  135| 
  136| 	{ export electrodes data }
  137| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair4_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  138| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair4_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  139| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair4_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  140| 
  141| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair4_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  142| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair4_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  143| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair4_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  144| 	
  145| { bot electrodes }
  146| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair4_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  147| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair4_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  148| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair4_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  149| 
  150| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair4_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  151| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair4_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  152| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair4_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  153| 	
  154| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2730 MS

SUMMARIZE 23 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 85, RNORM=1.88221e-07, XNORM=0.104326, 2 MS/IT 0.133593 uS/NODE
Orthomin/ILU ITERATION 49, RNORM=5.53012e-11, XNORM=5.8226e-06, 2 MS/IT 0.136939 uS/NODE
RMS Spatial Errors  1.278e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:42:24 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)
   19| 	{ electrode location }
   20| 	x_e = 0
   21| 	y_e = 0
   22| 	{ electrode patch radius }
   23| 	r_e = 0.5	 { 1cm diameter electrode }
   24| 	{ electrode positions }
   25| 	{ Fc1 }
   26| 	x_Fc1 = 3.511
   27| 	y_Fc1 = 3.502
   28| 	{ Fc2 }
   29| 	x_Fc2 = 3.511
   30| 	y_Fc2 = -3.502
   31| 	{ Cp1 }
   32| 	x_Cp1 = -3.510
   33| 	y_Cp1 = 3.502
   34| 	{ Cp2 }
   35| 	x_Cp2 = -3.510
   36| 	y_Cp2 = -3.502
   37| 	{ C3 }
   38| 	x_C3 = 0
   39| 	y_C3 = 6.837
   40| 	{ C4 }
   41| 	x_C4 = 0
   42| 	y_C4 = -6.837
   43| 
   44| 
   45| EQUATIONS
   46|     div(-sigma*grad(V)) = 0
   47| 
   48| EXTRUSION
   49|     { z from low to high }
   50|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   51|         layer 'LB1'
   52| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   53| 		layer 'LB2'
   54| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   55| 		layer 'L3'
   56| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   57| 		layer 'LT2'
   58| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   59| 		layer 'LT1'
   60|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   61| 
   62| BOUNDARIES
   63|     
   64|     surface 'ST1' natural(V) = 0
   65|     surface 'SB1' natural(V) = 0
   66| 	
   67| 	Region 1
   68| 		layer 'LT1' sigma=sigma_sc
   69| 		layer 'LB1' sigma=sigma_sc
   70| 		start(R_sc, 0)
   71| 		arc(center=0,0) angle=360
   72| 		line to close
   73| 
   74| { Electrode 1 }
   75| 	Limited Region  'ELECTRODE1'
   76| 		x_e = x_Fc1
   77| 		y_e = y_Fc1
   78| 		surface 'ST1'
   79| 		natural(V) = 1/(PI*(r_e^2))
   80|  		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 
   81| 		line to close
   82| 
   83| { Electrode 2 }
   84| 	Limited Region 'ELECTRODE2'
   85| 		x_e = x_C3
   86| 		y_e = y_C3
   87| 		surface 'ST1'
   88| 		natural(V) = -1/(PI*(r_e^2))
   89| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360 
   90| 		LINE TO CLOSE
   91| 
   92| 
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		x_e = (x_Fc1+x_C3)/2
   96| 		y_e = (y_Fc1+y_C3)/2
   97| 		surface 'ST1'
   98| 		value(V) = 0
   99| 		start(x_e, y_e+r_e) arc(center=x_e, y_e) ANGLE=360	{Ground}
  100| 		line to close
  101| 
  102| 	Limited Region 4 { the skull region }
  103| 		layer 'LT2' sigma = sigma_sk
  104| 		layer 'LB2' sigma = sigma_sk
  105| 			! region in all layers that must merge out:
  106| 			layer 'L3'
  107| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  108| 		line to close
  109| 
  110| 	Limited Region 5 { the brain region }
  111| 		layer 'L3' sigma = sigma_br
  112| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  113| 		line to close
  114| 
  115| 
  116| PLOTS
  117| 	grid(x,y,z)
  118| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  119| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  120| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  121| 	contour(V) on SURFACE 'ST1'
  122| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  123| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  124| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  125| 
  126| 
  127| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  128| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  129| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  130| 
  131| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  132| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  133| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  134| }
  135| 
  136| 	{ export electrodes data }
  137| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair4_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  138| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair4_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  139| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair4_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  140| 
  141| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair4_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  142| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair4_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  143| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair4_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  144| 	
  145| { bot electrodes }
  146| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair4_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  147| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair4_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  148| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair4_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  149| 
  150| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair4_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  151| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair4_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  152| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair4_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  153| 	
  154| end
SUBDIVIDE 897
SUBDIVIDE 898
SUBDIVIDE 583
SUBDIVIDE 826
SUBDIVIDE 828
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2820 MS

SUMMARIZE 23 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
            X_E      1                    1         72
            X_E      2                    1         72
            X_E      3                    1         72
            X_E      4                    1         72
            X_E      5                    1         72
            X_E      6                    1         72
            X_E      7                    1         72
            X_E      8                    1         72
            X_E      9                    1         72
            Y_E      1                    1         72
            Y_E      2                    1         72
            Y_E      3                    1         72
            Y_E      4                    1         72
            Y_E      5                    1         72
            Y_E      6                    1         72
            Y_E      7                    1         72
            Y_E      8                    1         72
            Y_E      9                    1         72
            R_E      0                    1         72
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 86, RNORM=1.9438e-07, XNORM=0.0811354, 2 MS/IT 0.128414 uS/NODE
Orthomin/ILU ITERATION 54, RNORM=4.73741e-11, XNORM=4.46367e-06, 2 MS/IT 0.132932 uS/NODE
RMS Spatial Errors  1.511e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:47:09 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc1
   40| 	y_e1 = y_Fc1
   41| 	x_e2 = x_C4
   42| 	y_e2 = y_C4
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair5_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair5_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair5_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair5_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair5_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair5_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair5_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair5_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair5_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair5_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair5_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair5_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  151| 	
  152| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2720 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 85, RNORM=1.88221e-07, XNORM=0.104326, 2 MS/IT 0.133593 uS/NODE
Orthomin/ILU ITERATION 49, RNORM=5.53012e-11, XNORM=5.8226e-06, 2 MS/IT 0.136939 uS/NODE
RMS Spatial Errors  1.278e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:48:15 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc2
   40| 	y_e1 = y_Fc2
   41| 	x_e2 = x_Cp1
   42| 	y_e2 = y_Cp1
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair6_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair6_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair6_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair6_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair6_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair6_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair6_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair6_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair6_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair6_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair6_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair6_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  151| 	
  152| end
SUBDIVIDE 494
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2820 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 45, RNORM=4.27541e-07, XNORM=0.0497534, 2 MS/IT 0.127681 uS/NODE
Orthomin/ILU ITERATION 91, RNORM=1.32274e-10, XNORM=8.68095e-05, 2 MS/IT 0.132017 uS/NODE
RMS Spatial Errors  1.221e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:49:03 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc2
   40| 	y_e1 = y_Fc2
   41| 	x_e2 = x_Cp2
   42| 	y_e2 = y_Cp2
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair7_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair7_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair7_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair7_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair7_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair7_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair7_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair7_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair7_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair7_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair7_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair7_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  151| 	
  152| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2680 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 47, RNORM=1.37086e-06, XNORM=0.0440171, 2 MS/IT 0.139063 uS/NODE
Orthomin/ILU ITERATION 87, RNORM=4.00751e-10, XNORM=0.00036388, 2 MS/IT 0.13147 uS/NODE
RMS Spatial Errors  1.278e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:49:51 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc2
   40| 	y_e1 = y_Fc2
   41| 	x_e2 = x_C3
   42| 	y_e2 = y_C3
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair8_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair8_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair8_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair8_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair8_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair8_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair8_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair8_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair8_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair8_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair8_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair8_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  151| 	
  152| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2780 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 88, RNORM=3.21853e-07, XNORM=0.104377, 2 MS/IT 0.135436 uS/NODE
Orthomin/ILU ITERATION 60, RNORM=4.58819e-11, XNORM=7.712e-06, 2 MS/IT 0.129547 uS/NODE
RMS Spatial Errors  1.217e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:50:46 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc2
   40| 	y_e1 = y_Fc2
   41| 	x_e2 = x_C4
   42| 	y_e2 = y_C4
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair9_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair9_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair9_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair9_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair9_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair9_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair9_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair9_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair9_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair9_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair9_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair9_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  151| 	
  152| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2790 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 81, RNORM=3.56461e-07, XNORM=0.0816484, 2 MS/IT 0.129933 uS/NODE
Orthomin/ILU ITERATION 52, RNORM=6.81079e-11, XNORM=9.13612e-06, 2 MS/IT 0.138481 uS/NODE
RMS Spatial Errors  1.286e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:51:47 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Cp1
   40| 	y_e1 = y_Cp1
   41| 	x_e2 = x_Cp2
   42| 	y_e2 = y_Cp2
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair10_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair10_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair10_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair10_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair10_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair10_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair10_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair10_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair10_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair10_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair10_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair10_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  151| 	
  152| end
SUBDIVIDE 444
SUBDIVIDE 984
SUBDIVIDE 982
SUBDIVIDE 446
SUBDIVIDE 738
SUBDIVIDE 990
SUBDIVIDE 1003
SUBDIVIDE 483
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 3070 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 46, RNORM=6.98582e-07, XNORM=0.0443725, 2 MS/IT 0.129624 uS/NODE
Orthomin/ILU ITERATION 92, RNORM=5.85724e-11, XNORM=0.000105809, 2 MS/IT 0.135516 uS/NODE
RMS Spatial Errors  1.315e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:52:58 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Cp1
   40| 	y_e1 = y_Cp1
   41| 	x_e2 = x_C3
   42| 	y_e2 = y_C3
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair11_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair11_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair11_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair11_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair11_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair11_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair11_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair11_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair11_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair11_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair11_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair11_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  151| 	
  152| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2740 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 82, RNORM=2.66051e-07, XNORM=0.081321, 2 MS/IT 0.134924 uS/NODE
Orthomin/ILU ITERATION 52, RNORM=7.2731e-11, XNORM=7.74414e-06, 2 MS/IT 0.127659 uS/NODE
RMS Spatial Errors  1.541e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:53:34 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Cp1
   40| 	y_e1 = y_Cp1
   41| 	x_e2 = x_C4
   42| 	y_e2 = y_C4
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair12_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair12_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair12_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair12_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair12_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair12_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair12_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair12_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair12_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair12_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair12_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair12_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  151| 	
  152| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2690 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 88, RNORM=2.63429e-07, XNORM=0.104413, 2 MS/IT 0.136404 uS/NODE
Orthomin/ILU ITERATION 53, RNORM=6.22899e-11, XNORM=5.68678e-06, 2 MS/IT 0.137859 uS/NODE
RMS Spatial Errors  1.242e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 12:55:55 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_C3
   40| 	y_e1 = y_C3
   41| 	x_e2 = x_C4
   42| 	y_e2 = y_C4
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair13_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair13_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair13_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair13_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair13_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair13_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair13_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair13_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair13_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair13_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair13_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair13_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  151| 	
  152| end
SUBDIVIDE 515
SUBDIVIDE 880
SUBDIVIDE 1135
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 3110 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/DInv ITERATION 132, RNORM=3.91841e-06, XNORM=0.133827, 0 MS/IT 0.0410934 uS/NODE
Orthomin/DInv ITERATION 312, RNORM=2.15404e-09, XNORM=0.0010464, 0 MS/IT 0.0379324 uS/NODE
RMS Spatial Errors  1.150e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 14:55:40 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_C3
   40| 	y_e1 = y_C3
   41| 	x_e2 = x_C4
   42| 	y_e2 = y_C4
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair13_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair13_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (51) file='Pair13_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair13_dx_z=2_8284.tbl' !format '#x, #y, #dx'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair13_dy_z=2_8284.tbl' !format '#x, #y, #dy'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (51) file='Pair13_dz_z=2_8284.tbl' !format '#x, #y, #dz'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair13_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair13_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (51) file='Pair13_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair13_dx_z=-2_8284.tbl' !format '#x, #y, #dx'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair13_dy_z=-2_8284.tbl' !format '#x, #y, #dy'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (51) file='Pair13_dz_z=-2_8284.tbl' !format '#x, #y, #dz'
  151| 	
  152| end
SUBDIVIDE 515
SUBDIVIDE 880
SUBDIVIDE 1135
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 3160 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/DInv ITERATION 132, RNORM=3.91841e-06, XNORM=0.133827, 0 MS/IT 0.0373576 uS/NODE
Orthomin/DInv ITERATION 312, RNORM=2.15404e-09, XNORM=0.0010464, 0 MS/IT 0.0395129 uS/NODE
RMS Spatial Errors  1.150e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 14:59:03 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc1
   40| 	y_e1 = y_Fc1
   41| 	x_e2 = x_Fc2
   42| 	y_e2 = y_Fc2
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dx_z=2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dy_z=2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dz_z=2_8284.txt' format '#x, #y, #1'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair1_dx_z=-2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair1_dy_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair1_dz_z=-2_8284.txt' format '#x, #y, #1'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair1_dx_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair1_dy_z=-2_8284.txt' format '#x, #y, #1'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair1_dz_z=-2_8284.txt' format '#x, #y, #1'
  151| 	
  152| end
SUBDIVIDE 954
SUBDIVIDE 582
SUBDIVIDE 583
SUBDIVIDE 954
SUBDIVIDE 955
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2800 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 46, RNORM=8.84227e-07, XNORM=0.0440873, 2 MS/IT 0.131023 uS/NODE
Orthomin/ILU ITERATION 85, RNORM=2.41464e-10, XNORM=0.000265329, 2 MS/IT 0.135367 uS/NODE
RMS Spatial Errors  1.255e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 14:59:51 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc1
   40| 	y_e1 = y_Fc1
   41| 	x_e2 = x_Cp1
   42| 	y_e2 = y_Cp1
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dx_z=2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dy_z=2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dz_z=2_8284.txt' format '#x, #y, #1'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair2_dx_z=-2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair2_dy_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair2_dz_z=-2_8284.txt' format '#x, #y, #1'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair2_dx_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair2_dy_z=-2_8284.txt' format '#x, #y, #1'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair2_dz_z=-2_8284.txt' format '#x, #y, #1'
  151| 	
  152| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2650 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 46, RNORM=1.65307e-06, XNORM=0.0440633, 2 MS/IT 0.129344 uS/NODE
Orthomin/ILU ITERATION 88, RNORM=3.66417e-10, XNORM=0.000336137, 2 MS/IT 0.135223 uS/NODE
RMS Spatial Errors  1.220e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:00:24 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc1
   40| 	y_e1 = y_Fc1
   41| 	x_e2 = x_Cp2
   42| 	y_e2 = y_Cp2
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair3_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair3_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair3_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair3_dx_z=2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair3_dy_z=2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair3_dz_z=2_8284.txt' format '#x, #y, #1'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair3_dx_z=-2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair3_dy_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair3_dz_z=-2_8284.txt' format '#x, #y, #1'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair3_dx_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair3_dy_z=-2_8284.txt' format '#x, #y, #1'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair3_dz_z=-2_8284.txt' format '#x, #y, #1'
  151| 	
  152| end
SUBDIVIDE 444
SUBDIVIDE 1013
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
STRETCH_MESH3 TIME = 10 MS
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2850 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 46, RNORM=3.61636e-07, XNORM=0.0489266, 2 MS/IT 0.126344 uS/NODE
Orthomin/ILU ITERATION 91, RNORM=1.0147e-10, XNORM=7.92575e-05, 2 MS/IT 0.133538 uS/NODE
RMS Spatial Errors  1.282e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:00:56 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc1
   40| 	y_e1 = y_Fc1
   41| 	x_e2 = x_C3
   42| 	y_e2 = y_C3
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dx_z=2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dy_z=2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dz_z=2_8284.txt' format '#x, #y, #1'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair4_dx_z=-2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair4_dy_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair4_dz_z=-2_8284.txt' format '#x, #y, #1'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair4_dx_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair4_dy_z=-2_8284.txt' format '#x, #y, #1'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair4_dz_z=-2_8284.txt' format '#x, #y, #1'
  151| 	
  152| end
SUBDIVIDE 897
SUBDIVIDE 898
SUBDIVIDE 583
SUBDIVIDE 826
SUBDIVIDE 828
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2850 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 86, RNORM=1.9438e-07, XNORM=0.0811354, 2 MS/IT 0.128414 uS/NODE
Orthomin/ILU ITERATION 54, RNORM=4.73741e-11, XNORM=4.46367e-06, 2 MS/IT 0.132932 uS/NODE
RMS Spatial Errors  1.511e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:01:38 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc1
   40| 	y_e1 = y_Fc1
   41| 	x_e2 = x_C4
   42| 	y_e2 = y_C4
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair5_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair5_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair5_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair5_dx_z=2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair5_dy_z=2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair5_dz_z=2_8284.txt' format '#x, #y, #1'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair5_dx_z=-2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair5_dy_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair5_dz_z=-2_8284.txt' format '#x, #y, #1'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair5_dx_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair5_dy_z=-2_8284.txt' format '#x, #y, #1'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair5_dz_z=-2_8284.txt' format '#x, #y, #1'
  151| 	
  152| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2720 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 85, RNORM=1.88221e-07, XNORM=0.104326, 2 MS/IT 0.133593 uS/NODE
Orthomin/ILU ITERATION 49, RNORM=5.53012e-11, XNORM=5.8226e-06, 2 MS/IT 0.136939 uS/NODE
RMS Spatial Errors  1.278e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:02:24 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc1
   40| 	y_e1 = y_Fc1
   41| 	x_e2 = x_Cp1
   42| 	y_e2 = y_Cp1
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair6_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair6_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair6_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair6_dx_z=2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair6_dy_z=2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair6_dz_z=2_8284.txt' format '#x, #y, #1'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair6_dx_z=-2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair6_dy_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair6_dz_z=-2_8284.txt' format '#x, #y, #1'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair6_dx_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair6_dy_z=-2_8284.txt' format '#x, #y, #1'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair6_dz_z=-2_8284.txt' format '#x, #y, #1'
  151| 	
  152| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2660 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 46, RNORM=1.65307e-06, XNORM=0.0440633, 2 MS/IT 0.129344 uS/NODE
Orthomin/ILU ITERATION 88, RNORM=3.66417e-10, XNORM=0.000336137, 2 MS/IT 0.129076 uS/NODE
RMS Spatial Errors  1.220e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:02:59 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc2
   40| 	y_e1 = y_Fc2
   41| 	x_e2 = x_Cp1
   42| 	y_e2 = y_Cp1
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair6_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair6_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair6_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair6_dx_z=2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair6_dy_z=2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair6_dz_z=2_8284.txt' format '#x, #y, #1'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair6_dx_z=-2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair6_dy_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair6_dz_z=-2_8284.txt' format '#x, #y, #1'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair6_dx_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair6_dy_z=-2_8284.txt' format '#x, #y, #1'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair6_dz_z=-2_8284.txt' format '#x, #y, #1'
  151| 	
  152| end
SUBDIVIDE 494
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2830 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 45, RNORM=4.27541e-07, XNORM=0.0497534, 2 MS/IT 0.127681 uS/NODE
Orthomin/ILU ITERATION 91, RNORM=1.32274e-10, XNORM=8.68095e-05, 2 MS/IT 0.137757 uS/NODE
RMS Spatial Errors  1.221e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:03:31 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc2
   40| 	y_e1 = y_Fc2
   41| 	x_e2 = x_Cp2
   42| 	y_e2 = y_Cp2
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair7_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair7_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair7_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair7_dx_z=2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair7_dy_z=2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair7_dz_z=2_8284.txt' format '#x, #y, #1'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair7_dx_z=-2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair7_dy_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair7_dz_z=-2_8284.txt' format '#x, #y, #1'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair7_dx_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair7_dy_z=-2_8284.txt' format '#x, #y, #1'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair7_dz_z=-2_8284.txt' format '#x, #y, #1'
  151| 	
  152| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2750 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 47, RNORM=1.37086e-06, XNORM=0.0440171, 2 MS/IT 0.139063 uS/NODE
Orthomin/ILU ITERATION 87, RNORM=4.00751e-10, XNORM=0.00036388, 2 MS/IT 0.13147 uS/NODE
RMS Spatial Errors  1.278e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:04:11 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc2
   40| 	y_e1 = y_Fc2
   41| 	x_e2 = x_C3
   42| 	y_e2 = y_C3
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair8_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair8_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair8_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair8_dx_z=2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair8_dy_z=2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair8_dz_z=2_8284.txt' format '#x, #y, #1'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair8_dx_z=-2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair8_dy_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair8_dz_z=-2_8284.txt' format '#x, #y, #1'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair8_dx_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair8_dy_z=-2_8284.txt' format '#x, #y, #1'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair8_dz_z=-2_8284.txt' format '#x, #y, #1'
  151| 	
  152| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2850 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 88, RNORM=3.21853e-07, XNORM=0.104377, 2 MS/IT 0.135436 uS/NODE
Orthomin/ILU ITERATION 60, RNORM=4.58819e-11, XNORM=7.712e-06, 2 MS/IT 0.138184 uS/NODE
RMS Spatial Errors  1.217e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:05:06 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Cp1
   40| 	y_e1 = y_Cp1
   41| 	x_e2 = x_Cp2
   42| 	y_e2 = y_Cp2
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair10_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair10_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair10_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair10_dx_z=2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair10_dy_z=2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair10_dz_z=2_8284.txt' format '#x, #y, #1'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair10_dx_z=-2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair10_dy_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair10_dz_z=-2_8284.txt' format '#x, #y, #1'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair10_dx_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair10_dy_z=-2_8284.txt' format '#x, #y, #1'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair10_dz_z=-2_8284.txt' format '#x, #y, #1'
  151| 	
  152| end
SUBDIVIDE 444
SUBDIVIDE 984
SUBDIVIDE 982
SUBDIVIDE 446
SUBDIVIDE 738
SUBDIVIDE 990
SUBDIVIDE 1003
SUBDIVIDE 483
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 3120 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 46, RNORM=6.98582e-07, XNORM=0.0443725, 2 MS/IT 0.129624 uS/NODE
Orthomin/ILU ITERATION 92, RNORM=5.85724e-11, XNORM=0.000105809, 2 MS/IT 0.135516 uS/NODE
RMS Spatial Errors  1.315e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:06:05 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Cp1
   40| 	y_e1 = y_Cp1
   41| 	x_e2 = x_C3
   42| 	y_e2 = y_C3
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dx_z=2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dy_z=2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dz_z=2_8284.txt' format '#x, #y, #1'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair11_dx_z=-2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair11_dy_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair11_dz_z=-2_8284.txt' format '#x, #y, #1'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair11_dx_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair11_dy_z=-2_8284.txt' format '#x, #y, #1'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair11_dz_z=-2_8284.txt' format '#x, #y, #1'
  151| 	
  152| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2760 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 82, RNORM=2.66051e-07, XNORM=0.081321, 2 MS/IT 0.14167 uS/NODE
Orthomin/ILU ITERATION 52, RNORM=7.2731e-11, XNORM=7.74414e-06, 2 MS/IT 0.138297 uS/NODE
RMS Spatial Errors  1.541e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:07:00 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Cp1
   40| 	y_e1 = y_Cp1
   41| 	x_e2 = x_C4
   42| 	y_e2 = y_C4
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair12_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair12_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair12_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair12_dx_z=2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair12_dy_z=2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair12_dz_z=2_8284.txt' format '#x, #y, #1'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair12_dx_z=-2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair12_dy_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair12_dz_z=-2_8284.txt' format '#x, #y, #1'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair12_dx_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair12_dy_z=-2_8284.txt' format '#x, #y, #1'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair12_dz_z=-2_8284.txt' format '#x, #y, #1'
  151| 	
  152| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2720 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 88, RNORM=2.63429e-07, XNORM=0.104413, 2 MS/IT 0.136404 uS/NODE
Orthomin/ILU ITERATION 53, RNORM=6.22899e-11, XNORM=5.68678e-06, 2 MS/IT 0.128012 uS/NODE
RMS Spatial Errors  1.242e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:07:46 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_C3
   40| 	y_e1 = y_C3
   41| 	x_e2 = x_C4
   42| 	y_e2 = y_C4
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export electrodes data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dx_z=2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dy_z=2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dz_z=2_8284.txt' format '#x, #y, #1'
  142| 	
  143| { bot electrodes }
  144| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair13_dx_z=-2_8284.txt' format '#x, #y, #1'
  145| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair13_dy_z=-2_8284.txt' format '#x, #y, #1'
  146| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=-2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=-2.8284' export (20) file='Pair13_dz_z=-2_8284.txt' format '#x, #y, #1'
  147| 
  148| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair13_dx_z=-2_8284.txt' format '#x, #y, #1'
  149| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair13_dy_z=-2_8284.txt' format '#x, #y, #1'
  150| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=-2.8284' export (20) file='Pair13_dz_z=-2_8284.txt' format '#x, #y, #1'
  151| 	
  152| end
SUBDIVIDE 515
SUBDIVIDE 880
SUBDIVIDE 1135
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 3170 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72
    15          1          1          1          1           72
    15          1          2          1          1           72
    15          1          3          1          1           72
    15          1          4          1          1           72
    15          1          5          1          1           72
    15          1          6          1          1           72
    15          1          7          1          1           72
    15          1          8          1          1           72
    15          1          9          1          1           72
    16          1          1          1          1           72
    16          1          2          1          1           72
    16          1          3          1          1           72
    16          1          4          1          1           72
    16          1          5          1          1           72
    16          1          6          1          1           72
    16          1          7          1          1           72
    16          1          8          1          1           72
    16          1          9          1          1           72
    17          1          1          1          1           72
    17          1          2          1          1           72
    17          1          3          1          1           72
    17          1          4          1          1           72
    17          1          5          1          1           72
    17          1          6          1          1           72
    17          1          7          1          1           72
    17          1          8          1          1           72
    17          1          9          1          1           72
    18          1          1          1          1           72
    18          1          2          1          1           72
    18          1          3          1          1           72
    18          1          4          1          1           72
    18          1          5          1          1           72
    18          1          6          1          1           72
    18          1          7          1          1           72
    18          1          8          1          1           72
    18          1          9          1          1           72
    19          1          1          1          1           72
    19          1          2          1          1           72
    19          1          3          1          1           72
    19          1          4          1          1           72
    19          1          5          1          1           72
    19          1          6          1          1           72
    19          1          7          1          1           72
    19          1          8          1          1           72
    19          1          9          1          1           72
    20          1          1          1          1           72
    20          1          2          1          1           72
    20          1          3          1          1           72
    20          1          4          1          1           72
    20          1          5          1          1           72
    20          1          6          1          1           72
    20          1          7          1          1           72
    20          1          8          1          1           72
    20          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/DInv ITERATION 132, RNORM=3.91841e-06, XNORM=0.133827, 0 MS/IT 0.0373576 uS/NODE
Orthomin/DInv ITERATION 312, RNORM=2.15404e-09, XNORM=0.0010464, 0 MS/IT 0.0379324 uS/NODE
RMS Spatial Errors  1.150e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:35:22 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc1
   40| 	y_e1 = y_Fc1
   41| 	x_e2 = x_Fc2
   42| 	y_e2 = y_Fc2
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export top dipoles data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair1_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dx_z=-2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dy_z=-2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair1_dz_z=-2_8284.txt' format '#x, #y, #1'
  142| 	
  143| end
SUBDIVIDE 954
SUBDIVIDE 582
SUBDIVIDE 583
SUBDIVIDE 954
SUBDIVIDE 955
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2890 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 46, RNORM=8.84227e-07, XNORM=0.0440873, 2 MS/IT 0.142934 uS/NODE
Orthomin/ILU ITERATION 85, RNORM=2.41464e-10, XNORM=0.000265329, 2 MS/IT 0.128921 uS/NODE
RMS Spatial Errors  1.255e-4
DO_NEXTSTAGE pde 0x7f817800ad70  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:36:44 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc1
   40| 	y_e1 = y_Fc1
   41| 	x_e2 = x_Cp1
   42| 	y_e2 = y_Cp1
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export top dipoles data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair2_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dx_z=-2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dy_z=-2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair2_dz_z=-2_8284.txt' format '#x, #y, #1'
  142| 	
  143| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2710 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 46, RNORM=1.65307e-06, XNORM=0.0440633, 2 MS/IT 0.129344 uS/NODE
Orthomin/ILU ITERATION 88, RNORM=3.66417e-10, XNORM=0.000336137, 2 MS/IT 0.135223 uS/NODE
RMS Spatial Errors  1.220e-4
DO_NEXTSTAGE pde 0x7f817a2a3fe0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:37:27 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc1
   40| 	y_e1 = y_Fc1
   41| 	x_e2 = x_Cp2
   42| 	y_e2 = y_Cp2
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export top dipoles data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair3_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair3_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair3_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair3_dx_z=-2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair3_dy_z=-2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair3_dz_z=-2_8284.txt' format '#x, #y, #1'
  142| 	
  143| end
SUBDIVIDE 444
SUBDIVIDE 1013
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
STRETCH_MESH3 TIME = 10 MS
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2840 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 46, RNORM=3.61636e-07, XNORM=0.0489266, 2 MS/IT 0.137829 uS/NODE
Orthomin/ILU ITERATION 91, RNORM=1.0147e-10, XNORM=7.92575e-05, 2 MS/IT 0.133538 uS/NODE
RMS Spatial Errors  1.282e-4
DO_NEXTSTAGE pde 0x7f817a2a3fe0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:38:09 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc1
   40| 	y_e1 = y_Fc1
   41| 	x_e2 = x_C3
   42| 	y_e2 = y_C3
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export top dipoles data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair4_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dx_z=-2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dy_z=-2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair4_dz_z=-2_8284.txt' format '#x, #y, #1'
  142| 	
  143| end
SUBDIVIDE 897
SUBDIVIDE 898
SUBDIVIDE 583
SUBDIVIDE 826
SUBDIVIDE 828
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2830 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 86, RNORM=1.9438e-07, XNORM=0.0811354, 2 MS/IT 0.134835 uS/NODE
Orthomin/ILU ITERATION 54, RNORM=4.73741e-11, XNORM=4.46367e-06, 2 MS/IT 0.132932 uS/NODE
RMS Spatial Errors  1.511e-4
DO_NEXTSTAGE pde 0x7f817a2a3fe0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:39:50 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc1
   40| 	y_e1 = y_Fc1
   41| 	x_e2 = x_C4
   42| 	y_e2 = y_C4
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export top dipoles data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair5_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair5_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair5_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair5_dx_z=-2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair5_dy_z=-2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair5_dz_z=-2_8284.txt' format '#x, #y, #1'
  142| 	
  143| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2710 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 85, RNORM=1.88221e-07, XNORM=0.104326, 2 MS/IT 0.133593 uS/NODE
Orthomin/ILU ITERATION 49, RNORM=5.53012e-11, XNORM=5.8226e-06, 2 MS/IT 0.126405 uS/NODE
RMS Spatial Errors  1.278e-4
DO_NEXTSTAGE pde 0x7f817a2a3fe0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:40:20 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc2
   40| 	y_e1 = y_Fc2
   41| 	x_e2 = x_Cp1
   42| 	y_e2 = y_Cp1
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export top dipoles data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair6_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair6_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair6_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair6_dx_z=-2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair6_dy_z=-2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair6_dz_z=-2_8284.txt' format '#x, #y, #1'
  142| 	
  143| end
SUBDIVIDE 494
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2980 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 45, RNORM=4.27541e-07, XNORM=0.0497534, 2 MS/IT 0.139288 uS/NODE
Orthomin/ILU ITERATION 91, RNORM=1.32274e-10, XNORM=8.68095e-05, 2 MS/IT 0.132017 uS/NODE
RMS Spatial Errors  1.221e-4
DO_NEXTSTAGE pde 0x7f817a2a3fe0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:44:45 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc2
   40| 	y_e1 = y_Fc2
   41| 	x_e2 = x_Cp2
   42| 	y_e2 = y_Cp2
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export top dipoles data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair7_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair7_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair7_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair7_dx_z=-2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair7_dy_z=-2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair7_dz_z=-2_8284.txt' format '#x, #y, #1'
  142| 	
  143| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2690 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 47, RNORM=1.37086e-06, XNORM=0.0440171, 2 MS/IT 0.127474 uS/NODE
Orthomin/ILU ITERATION 87, RNORM=4.00751e-10, XNORM=0.00036388, 2 MS/IT 0.13147 uS/NODE
RMS Spatial Errors  1.278e-4
DO_NEXTSTAGE pde 0x7f817a2a3fe0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:45:45 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Fc2
   40| 	y_e1 = y_Fc2
   41| 	x_e2 = x_C3
   42| 	y_e2 = y_C3
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export top dipoles data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair8_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair8_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair8_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair8_dx_z=-2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair8_dy_z=-2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair8_dz_z=-2_8284.txt' format '#x, #y, #1'
  142| 	
  143| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2820 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 88, RNORM=3.21853e-07, XNORM=0.104377, 2 MS/IT 0.129547 uS/NODE
Orthomin/ILU ITERATION 60, RNORM=4.58819e-11, XNORM=7.712e-06, 2 MS/IT 0.138184 uS/NODE
RMS Spatial Errors  1.217e-4
DO_NEXTSTAGE pde 0x7f817a2a3fe0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:46:26 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Cp1
   40| 	y_e1 = y_Cp1
   41| 	x_e2 = x_Cp2
   42| 	y_e2 = y_Cp2
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export top dipoles data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair10_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair10_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair10_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair10_dx_z=-2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair10_dy_z=-2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair10_dz_z=-2_8284.txt' format '#x, #y, #1'
  142| 	
  143| end
SUBDIVIDE 444
SUBDIVIDE 984
SUBDIVIDE 982
SUBDIVIDE 446
SUBDIVIDE 738
SUBDIVIDE 990
SUBDIVIDE 1003
SUBDIVIDE 483
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 3050 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 46, RNORM=6.98582e-07, XNORM=0.0443725, 2 MS/IT 0.129624 uS/NODE
Orthomin/ILU ITERATION 92, RNORM=5.85724e-11, XNORM=0.000105809, 2 MS/IT 0.135516 uS/NODE
RMS Spatial Errors  1.315e-4
DO_NEXTSTAGE pde 0x7f817a2a3fe0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:46:53 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Cp1
   40| 	y_e1 = y_Cp1
   41| 	x_e2 = x_C3
   42| 	y_e2 = y_C3
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export top dipoles data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair11_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dx_z=-2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dy_z=-2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair11_dz_z=-2_8284.txt' format '#x, #y, #1'
  142| 	
  143| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2770 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 82, RNORM=2.66051e-07, XNORM=0.081321, 2 MS/IT 0.128178 uS/NODE
Orthomin/ILU ITERATION 52, RNORM=7.2731e-11, XNORM=7.74414e-06, 2 MS/IT 0.138297 uS/NODE
RMS Spatial Errors  1.541e-4
DO_NEXTSTAGE pde 0x7f817a2a3fe0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:47:18 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_Cp1
   40| 	y_e1 = y_Cp1
   41| 	x_e2 = x_C4
   42| 	y_e2 = y_C4
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export top dipoles data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair12_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair12_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair12_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair12_dx_z=-2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair12_dy_z=-2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair12_dz_z=-2_8284.txt' format '#x, #y, #1'
  142| 	
  143| end
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 2770 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/ILU ITERATION 88, RNORM=2.63429e-07, XNORM=0.104413, 2 MS/IT 0.136404 uS/NODE
Orthomin/ILU ITERATION 53, RNORM=6.22899e-11, XNORM=5.68678e-06, 2 MS/IT 0.137859 uS/NODE
RMS Spatial Errors  1.242e-4
DO_NEXTSTAGE pde 0x7f817a2a3fe0  MAXSTAGE=0

================================================================
===  FlexPDE Version 6.36/L64  14:20:57 Jul 29 2014  © 1996-2014 PDE Solutions Inc.
===  /home/asy13/3shell_head_model/head_model_3shells.pde 15:47:55 4/6/15
================================================================
    1| TITLE 
    2|     'Head Model - 3 concentric spheres'
    3| 
    4| COORDINATES
    5|     cartesian3
    6| 
    7| VARIABLES
    8|     V
    9| 
   10| DEFINITIONS
   11|     sigma_br = 4.5   { mS/cm }
   12| 	sigma_sk = 0.056
   13| 	sigma_sc = 4.5
   14| 	sigma = sigma_br
   15|     R_sc = 9.2       { Scalp radius, cm }
   16| 	R_sk = 8.5
   17| 	R_br = 8
   18|     r = sqrt(x^2+y^2)	
   19| 	{ electrode positions }
   20| 	{ Fc1 }
   21| 	x_Fc1 = 3.511
   22| 	y_Fc1 = 3.502
   23| 	{ Fc2 }
   24| 	x_Fc2 = 3.511
   25| 	y_Fc2 = -3.502
   26| 	{ Cp1 }
   27| 	x_Cp1 = -3.510
   28| 	y_Cp1 = 3.502
   29| 	{ Cp2 }
   30| 	x_Cp2 = -3.510
   31| 	y_Cp2 = -3.502
   32| 	{ C3 }
   33| 	x_C3 = 0
   34| 	y_C3 = 6.837
   35| 	{ C4 }
   36| 	x_C4 = 0
   37| 	y_C4 = -6.837
   38| 	{ electrode location }
   39| 	x_e1 = x_C3
   40| 	y_e1 = y_C3
   41| 	x_e2 = x_C4
   42| 	y_e2 = y_C4
   43| 	x_g = (x_e1+x_e2)/2
   44| 	y_g = (y_e1+y_e2)/2
   45| 	{ electrode patch radius }
   46| 	r_e = 0.5	 { 1cm diameter electrode }
   47| 
   48| EQUATIONS
   49|     div(-sigma*grad(V)) = 0
   50| 
   51| EXTRUSION
   52|     { z from low to high }
   53|     surface 'SB1' z = -SPHERE ((0,0,0), R_sc)      { bottom of scalp shell }
   54|         layer 'LB1'
   55| 	surface 'SB2' z = -SPHERE ((0,0,0), R_sk)
   56| 		layer 'LB2'
   57| 	surface 'SB3' z = -SPHERE ((0,0,0), R_br)
   58| 		layer 'L3'
   59| 	surface 'ST3' z = SPHERE ((0,0,0), R_br)
   60| 		layer 'LT2'
   61| 	surface 'ST2' z = SPHERE ((0,0,0), R_sk)
   62| 		layer 'LT1'
   63|     surface 'ST1' z = SPHERE ((0,0,0), R_sc)
   64| 
   65| BOUNDARIES
   66|     
   67|     surface 'ST1' natural(V) = 0
   68|     surface 'SB1' natural(V) = 0
   69| 	
   70| 	Region 1
   71| 		layer 'LT1' sigma=sigma_sc
   72| 		layer 'LB1' sigma=sigma_sc
   73| 		start(R_sc, 0)
   74| 		arc(center=0,0) angle=360
   75| 		line to close
   76| 
   77| { Electrode 1 }
   78| 	Limited Region  'ELECTRODE1'
   79| 		surface 'ST1'
   80| 		natural(V) = 1/(PI*(r_e^2))
   81|  		start(x_e1, y_e1+r_e) arc(center=x_e1, y_e1) ANGLE=360 
   82| 		line to close
   83| 
   84| { Electrode 2 }
   85| 	Limited Region 'ELECTRODE2'
   86| 		surface 'ST1'
   87| 		natural(V) = -1/(PI*(r_e^2))
   88| 		start(x_e2, y_e2+r_e) arc(center=x_e2, y_e2) ANGLE=360 
   89| 		LINE TO CLOSE
   90| 
   91| 
   92| { 'Ground electrode' }
   93| 	Limited Region 3 { arbitrary ground point as a test }
   94| 		{ Ground voltage value between the electrodes }
   95| 		surface 'ST1'
   96| 		value(V) = 0
   97| 		start(x_g, y_g+r_e) arc(center=x_g, y_g) ANGLE=360	{Ground}
   98| 		line to close
   99| 
  100| 	Limited Region 4 { the skull region }
  101| 		layer 'LT2' sigma = sigma_sk
  102| 		layer 'LB2' sigma = sigma_sk
  103| 			! region in all layers that must merge out:
  104| 			layer 'L3'
  105| 		start(R_sk, 0) arc(center=0, 0) ANGLE=360
  106| 		line to close
  107| 
  108| 	Limited Region 5 { the brain region }
  109| 		layer 'L3' sigma = sigma_br
  110| 		start(R_br, 0) arc(center=0,0) ANGLE=360
  111| 		line to close
  112| 
  113| 
  114| PLOTS
  115| 	grid(x,y,z)
  116| 	contour(V) on x=0 as 'Potentail on YZ plane through diameter'
  117| 	contour(V) on y=0 	as 'Potential on XZ plane through diameter'
  118| 	contour(V) on z=0	as 'Potential on XY plane through diameter'
  119| 	contour(V) on SURFACE 'ST1'
  120| 	!elevation(V) on y=0 on SURFACE 'ST1' as 'Potential along y=0 on top surface'
  121| 	elevation(V) FROM (0, R_sc) to (0, -R_sc) on SURFACE 'ST1' as 'Potential along x=0 on top surface'
  122| 	vector(dx(V), dz(V)) on y=0 as '(dx, dz) on XZ plane at y=0'
  123| 
  124| 
  125| 	vector(dx(V), dy(V)) on z=2.8284 as '(dx, dy) on XY plane at z=2.8284'
  126| {	contour(dy(V)) on z=2.8284 as 'dV/dy on XY plane at z=2.8284' 
  127| 	contour(dz(V)) on z=2.8284 as 'dV/dz on XY plane at z=2.8284'
  128| 
  129| 	contour(dx(V)) on z=-2.8284 as 'dV/dx on XY plane at z=-2.8284'
  130| 	contour(dy(V)) on z=-2.8284 as 'dV/dy on XY plane at z=-2.8284'
  131| 	contour(dz(V)) on z=-2.8284 as 'dV/dz on XY plane at z=-2.8284' 
  132| }
  133| 
  134| 	{ export top dipoles data }
  135| 	elevation(dx(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dx FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dx_z=2_8284.txt' format '#x, #y, #1'
  136| 	elevation(dy(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dy FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dy_z=2_8284.txt' format '#x, #y, #1'
  137| 	elevation(dz(V)) FROM (-2, 2) to (2, -2) on z=2.8284 as 'dV/dz FROM (-2, 2) to (2, -2) on z=2.8284' export (20) file='Pair13_dz_z=2_8284.txt' format '#x, #y, #1'
  138| 
  139| 	elevation(dx(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dx FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dx_z=-2_8284.txt' format '#x, #y, #1'
  140| 	elevation(dy(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dy FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dy_z=-2_8284.txt' format '#x, #y, #1'
  141| 	elevation(dz(V)) FROM (-2, -2) to (2, 2) on z=-2.8284 as 'dV/dz FROM (-2, -2) to (2, 2) on z=2.8284' export (20) file='Pair13_dz_z=-2_8284.txt' format '#x, #y, #1'
  142| 	
  143| end
SUBDIVIDE 515
SUBDIVIDE 880
SUBDIVIDE 1135
MESH GENERATION LAYER 1 REGION 1
MESH GENERATION LAYER 2 REGION 5
MESH GENERATION LAYER 3 REGION 6
MESH GENERATION LAYER 4 REGION 5
MESH GENERATION LAYER 5 REGION 1

3D MESH GENERATION TIME 3140 MS

SUMMARIZE 27 PARAMETERS (NO COMMON SUBEXPRESSION ELIMINATION)
   Param         Compartment       Complexity     Memory
--------------------------------------------------------------
       SIGMA_BR      0                    1         72
       SIGMA_SK      0                    1         72
       SIGMA_SC      0                    1         72
          SIGMA      1                    1         72
          SIGMA      2                    1         72
          SIGMA      3                    1         72
          SIGMA      4                    1         72
          SIGMA      5                    1         72
          SIGMA      6                    1         72
          SIGMA      7                    1         72
          SIGMA      8                    1         72
          SIGMA      9                    1         72
           R_SC      0                    1         72
           R_SK      0                    1         72
           R_BR      0                    1         72
              R      0                    6        432
          X_FC1      0                    1         72
          Y_FC1      0                    1         72
          X_FC2      0                    1         72
          Y_FC2      0                    1         72
          X_CP1      0                    1         72
          Y_CP1      0                    1         72
          X_CP2      0                    1         72
          Y_CP2      0                    1         72
           X_C3      0                    1         72
           Y_C3      0                    1         72
           X_C4      0                    1         72
           Y_C4      0                    1         72
           X_E1      0                    1         72
           Y_E1      0                    1         72
           X_E2      0                    1         72
           Y_E2      0                    1         72
            X_G      0                    1         72
            Y_G      0                    1         72
            R_E      0                    1         72

SUMMARIZE EQUATIONS

                                                    BASE         CSE
 EQUATION  COMPARTMENT              FUNCTION     COMPLEXITY  COMPLEXITY    MEMORY
----------------------------------------------------------------------------------
     1          1                     Source          1            2          144
     1          1                   Galerkin         14           14         1008
     1          1       Var  1      Jacobian         14           14         1008
     1          1              Surf Galerkin         15           15         1080
     1          1       Var  1 Surf Jacobian         15           14         1008
     1          2                     Source          1            2          144
     1          2                   Galerkin         14           14         1008
     1          2       Var  1      Jacobian         14           14         1008
     1          2              Surf Galerkin         15           15         1080
     1          2       Var  1 Surf Jacobian         15           14         1008
     1          3                     Source          1            2          144
     1          3                   Galerkin         14           14         1008
     1          3       Var  1      Jacobian         14           14         1008
     1          3              Surf Galerkin         15           15         1080
     1          3       Var  1 Surf Jacobian         15           14         1008
     1          4                     Source          1            2          144
     1          4                   Galerkin         14           14         1008
     1          4       Var  1      Jacobian         14           14         1008
     1          4              Surf Galerkin         15           15         1080
     1          4       Var  1 Surf Jacobian         15           14         1008
     1          5                     Source          1            2          144
     1          5                   Galerkin         14           14         1008
     1          5       Var  1      Jacobian         14           14         1008
     1          5              Surf Galerkin         15           15         1080
     1          5       Var  1 Surf Jacobian         15           14         1008
     1          6                     Source          1            2          144
     1          6                   Galerkin         14           14         1008
     1          6       Var  1      Jacobian         14           14         1008
     1          6              Surf Galerkin         15           15         1080
     1          6       Var  1 Surf Jacobian         15           14         1008
     1          7                     Source          1            2          144
     1          7                   Galerkin         14           14         1008
     1          7       Var  1      Jacobian         14           14         1008
     1          7              Surf Galerkin         15           15         1080
     1          7       Var  1 Surf Jacobian         15           14         1008
     1          8                     Source          1            2          144
     1          8                   Galerkin         14           14         1008
     1          8       Var  1      Jacobian         14           14         1008
     1          8              Surf Galerkin         15           15         1080
     1          8       Var  1 Surf Jacobian         15           14         1008
     1          9                     Source          1            2          144
     1          9                   Galerkin         14           14         1008
     1          9       Var  1      Jacobian         14           14         1008
     1          9              Surf Galerkin         15           15         1080
     1          9       Var  1 Surf Jacobian         15           14         1008

EQUATION 1 PARAMETER DEPENDENCIES:
 SIGMA_BR        SIGMA_SK        SIGMA_SC        SIGMA          

SUMMARIZE BOUNDARY CONDITIONS

    BC     COMPARTMENT              FUNCTION     COMPLEXITY    MEMORY
----------------------------------------------------------------------
     1          1              Surf Galerkin          1         72
     1          1       Var  1 Surf Jacobian          1         72
     1          2              Surf Galerkin          1         72
     1          2       Var  1 Surf Jacobian          1         72
     1          3              Surf Galerkin          1         72
     1          3       Var  1 Surf Jacobian          1         72
     1          4              Surf Galerkin          1         72
     1          4       Var  1 Surf Jacobian          1         72
     1          5              Surf Galerkin          1         72
     1          5       Var  1 Surf Jacobian          1         72
     2          1              Surf Galerkin          2        144
     2          1       Var  1 Surf Jacobian          1         72
     2          2              Surf Galerkin          2        144
     2          2       Var  1 Surf Jacobian          1         72
     2          3              Surf Galerkin          2        144
     2          3       Var  1 Surf Jacobian          1         72
     3          1              Surf Galerkin          2        144
     3          1       Var  1 Surf Jacobian          1         72
     3          2              Surf Galerkin          2        144
     3          2       Var  1 Surf Jacobian          1         72
     3          3              Surf Galerkin          2        144
     3          3       Var  1 Surf Jacobian          1         72
     4          1              Surf Galerkin          1         72
     4          1       Var  1 Surf Jacobian          1         72
     4          2              Surf Galerkin          1         72
     4          2       Var  1 Surf Jacobian          1         72
     4          3              Surf Galerkin          1         72
     4          3       Var  1 Surf Jacobian          1         72

SUMMARIZE PLOT EQUATIONS

                                     BASE        CSE
   PLOT    ARGUMENT COMPARTMENT  COMPLEXITY  COMPLEXITY    MEMORY
------------------------------------------------------------------
     1          1          1          1          1           72
     1          1          2          1          1           72
     1          1          3          1          1           72
     1          1          4          1          1           72
     1          1          5          1          1           72
     1          1          6          1          1           72
     1          1          7          1          1           72
     1          1          8          1          1           72
     1          1          9          1          1           72
     1          2          1          1          1           72
     1          2          2          1          1           72
     1          2          3          1          1           72
     1          2          4          1          1           72
     1          2          5          1          1           72
     1          2          6          1          1           72
     1          2          7          1          1           72
     1          2          8          1          1           72
     1          2          9          1          1           72
     1          3          1          1          1           72
     1          3          2          1          1           72
     1          3          3          1          1           72
     1          3          4          1          1           72
     1          3          5          1          1           72
     1          3          6          1          1           72
     1          3          7          1          1           72
     1          3          8          1          1           72
     1          3          9          1          1           72
     2          1          1          1          1           72
     2          1          2          1          1           72
     2          1          3          1          1           72
     2          1          4          1          1           72
     2          1          5          1          1           72
     2          1          6          1          1           72
     2          1          7          1          1           72
     2          1          8          1          1           72
     2          1          9          1          1           72
     3          1          1          1          1           72
     3          1          2          1          1           72
     3          1          3          1          1           72
     3          1          4          1          1           72
     3          1          5          1          1           72
     3          1          6          1          1           72
     3          1          7          1          1           72
     3          1          8          1          1           72
     3          1          9          1          1           72
     4          1          1          1          1           72
     4          1          2          1          1           72
     4          1          3          1          1           72
     4          1          4          1          1           72
     4          1          5          1          1           72
     4          1          6          1          1           72
     4          1          7          1          1           72
     4          1          8          1          1           72
     4          1          9          1          1           72
     5          1          1          1          1           72
     5          1          2          1          1           72
     5          1          3          1          1           72
     5          1          4          1          1           72
     5          1          5          1          1           72
     5          1          6          1          1           72
     5          1          7          1          1           72
     5          1          8          1          1           72
     5          1          9          1          1           72
     6          1          1          1          1           72
     6          1          2          1          1           72
     6          1          3          1          1           72
     6          1          4          1          1           72
     6          1          5          1          1           72
     6          1          6          1          1           72
     6          1          7          1          1           72
     6          1          8          1          1           72
     6          1          9          1          1           72
     7          1          1          3          3          216
     7          1          2          3          3          216
     7          1          3          3          3          216
     7          1          4          3          3          216
     7          1          5          3          3          216
     7          1          6          3          3          216
     7          1          7          3          3          216
     7          1          8          3          3          216
     7          1          9          3          3          216
     8          1          1          3          3          216
     8          1          2          3          3          216
     8          1          3          3          3          216
     8          1          4          3          3          216
     8          1          5          3          3          216
     8          1          6          3          3          216
     8          1          7          3          3          216
     8          1          8          3          3          216
     8          1          9          3          3          216
     9          1          1          1          1           72
     9          1          2          1          1           72
     9          1          3          1          1           72
     9          1          4          1          1           72
     9          1          5          1          1           72
     9          1          6          1          1           72
     9          1          7          1          1           72
     9          1          8          1          1           72
     9          1          9          1          1           72
    10          1          1          1          1           72
    10          1          2          1          1           72
    10          1          3          1          1           72
    10          1          4          1          1           72
    10          1          5          1          1           72
    10          1          6          1          1           72
    10          1          7          1          1           72
    10          1          8          1          1           72
    10          1          9          1          1           72
    11          1          1          1          1           72
    11          1          2          1          1           72
    11          1          3          1          1           72
    11          1          4          1          1           72
    11          1          5          1          1           72
    11          1          6          1          1           72
    11          1          7          1          1           72
    11          1          8          1          1           72
    11          1          9          1          1           72
    12          1          1          1          1           72
    12          1          2          1          1           72
    12          1          3          1          1           72
    12          1          4          1          1           72
    12          1          5          1          1           72
    12          1          6          1          1           72
    12          1          7          1          1           72
    12          1          8          1          1           72
    12          1          9          1          1           72
    13          1          1          1          1           72
    13          1          2          1          1           72
    13          1          3          1          1           72
    13          1          4          1          1           72
    13          1          5          1          1           72
    13          1          6          1          1           72
    13          1          7          1          1           72
    13          1          8          1          1           72
    13          1          9          1          1           72
    14          1          1          1          1           72
    14          1          2          1          1           72
    14          1          3          1          1           72
    14          1          4          1          1           72
    14          1          5          1          1           72
    14          1          6          1          1           72
    14          1          7          1          1           72
    14          1          8          1          1           72
    14          1          9          1          1           72

==UNUSED== PARAMETER DEFINITIONS:
 R               X_FC1           Y_FC1           X_FC2           Y_FC2          
 X_CP1           Y_CP1           X_CP2           Y_CP2           X_C3           
 Y_C3            X_C4            Y_C4           

Orthomin/DInv ITERATION 132, RNORM=3.91841e-06, XNORM=0.133827, 0 MS/IT 0.0373576 uS/NODE
Orthomin/DInv ITERATION 312, RNORM=2.15404e-09, XNORM=0.0010464, 0 MS/IT 0.0379324 uS/NODE
RMS Spatial Errors  1.150e-4
DO_NEXTSTAGE pde 0x7f817a2a3fe0  MAXSTAGE=0
